# NDR-lite ‚Äî –°–µ—Ç–µ–≤–æ–π –î–µ—Ç–µ–∫—Ç–æ—Ä –£–≥—Ä–æ–∑
## MVP Plan

---

## üíº –û—Ñ—Ñ–µ—Ä

### –ß—Ç–æ —ç—Ç–æ

NDR-lite ‚Äî —Å–∏—Å—Ç–µ–º–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∏ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ —Å–µ—Ç–µ–≤—ã–µ —É–≥—Ä–æ–∑—ã (Network Detection & Response). –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ –∑–µ—Ä–∫–∞–ª—É —Ç—Ä–∞—Ñ–∏–∫–∞, –∑–∞ 24 —á–∞—Å–∞ —Å—Ç—Ä–æ–∏—Ç –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é –∫–∞—Ä—Ç—É —Å–µ—Ç–∏ –∏ –Ω–∞—á–∏–Ω–∞–µ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å –∞—Ç–∞–∫–∏. AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –æ–±—ä—è—Å–Ω—è–µ—Ç –∫–∞–∂–¥—ã–π –∏–Ω—Ü–∏–¥–µ–Ω—Ç —á–µ–ª–æ–≤–µ—á–µ—Å–∫–∏–º —è–∑—ã–∫–æ–º –∏ –≥–æ–≤–æ—Ä–∏—Ç —á—Ç–æ –¥–µ–ª–∞—Ç—å.

### –î–ª—è –∫–æ–≥–æ

–ö–æ–º–ø–∞–Ω–∏–∏ –æ—Ç 50 –¥–æ 1000 —Ä–∞–±–æ—á–∏—Ö –º–µ—Å—Ç, —É –∫–æ—Ç–æ—Ä—ã—Ö:
- –ù–µ—Ç –±—é–¥–∂–µ—Ç–∞ –Ω–∞ PT NAD (–æ—Ç 5 –º–ª–Ω/–≥–æ–¥) –∏–ª–∏ Darktrace (–æ—Ç 15 –º–ª–Ω/–≥–æ–¥)
- –ù–µ—Ç –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–π –∫–æ–º–∞–Ω–¥—ã SOC ‚Äî –ò–ë –≤–µ–¥—ë—Ç 1-2 —á–µ–ª–æ–≤–µ–∫–∞ –∏–ª–∏ —Å–æ–≤–º–µ—â–∞—é—Ç —Å IT
- –ï—Å—Ç—å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è 187-–§–ó (–ö–ò–ò) –∏–ª–∏ –æ—Ç—Ä–∞—Å–ª–µ–≤—ã–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã –ò–ë
- –£—à–ª–∏ –∏–Ω–æ—Å—Ç—Ä–∞–Ω–Ω—ã–µ –≤–µ–Ω–¥–æ—Ä—ã (Cisco Stealthwatch, Vectra, Darktrace) –∏ –Ω—É–∂–Ω–∞ –∑–∞–º–µ–Ω–∞

### –ì–ª–∞–≤–Ω–æ–µ –æ–±–µ—â–∞–Ω–∏–µ

**¬´–£—Å—Ç–∞–Ω–æ–≤–∏–ª –∑–∞ 30 –º–∏–Ω—É—Ç ‚Äî —á–µ—Ä–µ–∑ —Å—É—Ç–∫–∏ –∑–Ω–∞–µ—à—å —Å–≤–æ—é —Å–µ—Ç—å –ª—É—á—à–µ, —á–µ–º –∑–∞ 10 –ª–µ—Ç —Ä–∞–±–æ—Ç—ã¬ª**

–ö–æ–Ω–∫—Ä–µ—Ç–Ω–æ:
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–∞—Ä—Ç–∞ –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –∏ —Å–≤—è–∑–µ–π –≤ —Å–µ—Ç–∏ (–±–µ–∑ —Ä—É—á–Ω–æ–≥–æ –≤–≤–æ–¥–∞)
- –í–∏–∑—É–∞–ª—å–Ω—ã–π –≥—Ä–∞—Ñ: –≤–∏–¥–Ω–æ –∫—Ç–æ —Å –∫–µ–º –æ–±—â–∞–µ—Ç—Å—è, –≥–¥–µ –∞–Ω–æ–º–∞–ª–∏–∏, –≥–¥–µ –¥—ã—Ä—ã
- –ï—Å–ª–∏ —Ö–∞–∫–µ—Ä –ø—Ä–æ–Ω–∏–∫ ‚Äî —Å–∏—Å—Ç–µ–º–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –µ–≥–æ –ø—É—Ç—å –ø–æ —Å–µ—Ç–∏ –Ω–∞ –≥—Ä–∞—Ñ–µ
- AI –æ–±—ä—è—Å–Ω—è–µ—Ç: ¬´–í–æ—Ç —á—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ, –≤–æ—Ç –ø–æ—á–µ–º—É –æ–ø–∞—Å–Ω–æ, –≤–æ—Ç —á—Ç–æ –¥–µ–ª–∞—Ç—å ‚Äî –ø–æ —à–∞–≥–∞–º¬ª
- –ì–æ—Ç–æ–≤—ã–π PDF-–æ—Ç—á—ë—Ç –¥–ª—è —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞ –∏ –∞—É–¥–∏—Ç–æ—Ä–æ–≤

### –§–æ—Ä–º–∞—Ç –ø—Ä–æ–¥–∞–∂–∏

| –≠—Ç–∞–ø | –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç | –î–ª—è –∫–ª–∏–µ–Ω—Ç–∞ |
|------|---------------|-------------|
| **–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –∞—É–¥–∏—Ç 48—á** | –°—Ç–∞–≤–∏–º 1 —Å–µ–Ω—Å–æ—Ä, —Å–æ–±–∏—Ä–∞–µ–º —Ç—Ä–∞—Ñ–∏–∫ | –ë–µ—Å–ø–ª–∞—Ç–Ω–æ, –±–µ–∑ –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤ |
| **–û—Ç—á—ë—Ç** | –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º PDF: –∫–∞—Ä—Ç–∞ —Å–µ—Ç–∏, –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã, –ø—É—Ç–∏ –∞—Ç–∞–∫ | –ö–ª–∏–µ–Ω—Ç –≤–∏–¥–∏—Ç —Ü–µ–Ω–Ω–æ—Å—Ç—å |
| **–î–µ–º–æ** | –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–∞—à–±–æ—Ä–¥, –≥—Ä–∞—Ñ, AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞ –Ω–∞ –µ–≥–æ –¥–∞–Ω–Ω—ã—Ö | ¬´–í–æ—Ç —Ç–∞–∫ —ç—Ç–æ –≤—ã–≥–ª—è–¥–∏—Ç —É –≤–∞—Å¬ª |
| **–ü–æ–¥–ø–∏—Å–∫–∞** | –ï–∂–µ–º–µ—Å—è—á–Ω–∞—è/–≥–æ–¥–æ–≤–∞—è | 70-200–∫ —Ä—É–±/–º–µ—Å |

### –ß—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç—å –∫–ª–∏–µ–Ω—Ç—É

**–ï—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç —Å—á–∏—Ç–∞–µ—Ç, —á—Ç–æ —É –Ω–µ–≥–æ ¬´–≤—Å—ë –Ω–æ—Ä–º–∞–ª—å–Ω–æ¬ª:**
> ¬´–î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏–º –±–µ—Å–ø–ª–∞—Ç–Ω–æ –∑–∞ 48 —á–∞—Å–æ–≤. –°—Ç–∞–≤–∏–º –∫–æ—Ä–æ–±–∫—É, –æ–Ω–∞ —Å–ª—É—à–∞–µ—Ç —Ç—Ä–∞—Ñ–∏–∫. –ß–µ—Ä–µ–∑ –¥–≤–æ–µ —Å—É—Ç–æ–∫ –ø–æ–∫–∞–∂–µ–º –∫–∞—Ä—Ç—É –≤–∞—à–µ–π —Å–µ—Ç–∏ –∏ —á—Ç–æ –ø–æ –Ω–µ–π —Ö–æ–¥–∏—Ç. –ï—Å–ª–∏ –≤—Å—ë —á–∏—Å—Ç–æ ‚Äî –æ—Ç–ª–∏—á–Ω–æ, –º—ã –ø–æ–∂–º—ë–º —Ä—É–∫–∏. –í 9 –∏–∑ 10 —Å–ª—É—á–∞–µ–≤ –Ω–∞—Ö–æ–¥–∏–º —Ç–æ, –æ —á—ë–º –Ω–µ –∑–Ω–∞–ª–∏.¬ª

**–ï—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –≥–æ–≤–æ—Ä–∏—Ç ¬´—É –Ω–∞—Å –µ—Å—Ç—å —Ñ–∞–π—Ä–≤–æ–ª¬ª:**
> ¬´–§–∞–π—Ä–≤–æ–ª –∑–∞—â–∏—â–∞–µ—Ç –ø–µ—Ä–∏–º–µ—Ç—Ä. –ê —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤–Ω—É—Ç—Ä–∏ —Å–µ—Ç–∏ ‚Äî –∫—Ç–æ –∫—É–¥–∞ —Ö–æ–¥–∏—Ç, –Ω–µ—Ç –ª–∏ —á—É–∂–∏—Ö, –Ω–µ —É—Ç–µ–∫–∞—é—Ç –ª–∏ –¥–∞–Ω–Ω—ã–µ ‚Äî —Ñ–∞–π—Ä–≤–æ–ª –Ω–µ –≤–∏–¥–∏—Ç. –ú—ã –≤–∏–¥–∏–º. –ò –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω–∞ –ø–æ–Ω—è—Ç–Ω–æ–π –∫–∞—Ä—Ç–µ.¬ª

**–ï—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç —Å PT NAD:**
> ¬´PT NAD ‚Äî –æ—Ç–ª–∏—á–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç –¥–ª—è –∫—Ä—É–ø–Ω—ã—Ö –∫–æ–º–ø–∞–Ω–∏–π —Å –∫–æ–º–∞–Ω–¥–æ–π SOC –∏ –±—é–¥–∂–µ—Ç–æ–º –æ—Ç 5 –º–ª–Ω. –£ –Ω–∞—Å –µ—Å—Ç—å —Ç–æ, —á–µ–≥–æ –Ω–µ—Ç –¥–∞–∂–µ —É –Ω–∏—Ö: –≥—Ä–∞—Ñ–æ–≤–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ (–≤–∏–¥–Ω–æ –ø—É—Ç—å —Ö–∞–∫–µ—Ä–∞ –ø–æ —Å–µ—Ç–∏) –∏ AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç (–æ–±—ä—è—Å–Ω—è–µ—Ç –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã –±–µ–∑ SOC-–∞–Ω–∞–ª–∏—Ç–∏–∫–∞). –ò —Å—Ç–æ–∏–º –≤ 5-10 —Ä–∞–∑ –¥–µ—à–µ–≤–ª–µ.¬ª

**–ï—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç –ø—Ä–æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –§–°–¢–≠–ö:**
> ¬´–ú—ã –ø–æ–¥–∞—ë–º –∑–∞—è–≤–∫—É –Ω–∞ –≤–Ω–µ—Å–µ–Ω–∏–µ –≤ —Ä–µ–µ—Å—Ç—Ä —Ä–æ—Å—Å–∏–π—Å–∫–æ–≥–æ –ü–û —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –≤—ã—Ö–æ–¥–∞ –ø—Ä–æ–¥—É–∫—Ç–∞. –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –§–°–¢–≠–ö ‚Äî –≤ –ø–ª–∞–Ω–µ –Ω–∞ —Å–ª–µ–¥—É—é—â—É—é –≤–µ—Ä—Å–∏—é. –î–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏—Ö –∫–æ–º–ø–∞–Ω–∏–π —Ä–µ–µ—Å—Ç—Ä –¥–æ—Å—Ç–∞—Ç–æ—á–µ–Ω, —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω—É–∂–Ω–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è –≥–æ—Å—Ç–∞–π–Ω—ã –∏ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π –ö–ò–ò.¬ª

---

## ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–æ–¥—É–∫—Ç–∞

### 1. –ì—Ä–∞—Ñ–æ–≤–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ —Å–µ—Ç–∏ ‚Äî –Ω–µ—Ç –Ω–∏ —É –∫–æ–≥–æ –≤ —ç—Ç–æ–º —Ü–µ–Ω–æ–≤–æ–º —Å–µ–≥–º–µ–Ω—Ç–µ

–°–µ—Ç—å ‚Äî —ç—Ç–æ –≥—Ä–∞—Ñ: —É–∑–ª—ã (–∫–æ–º–ø—å—é—Ç–µ—Ä—ã) –∏ —Å–≤—è–∑–∏ (—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è). –ú—ã —Ö—Ä–∞–Ω–∏–º –µ—ë –∏–º–µ–Ω–Ω–æ –∫–∞–∫ –≥—Ä–∞—Ñ –≤ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö (Dgraph). –≠—Ç–æ –¥–∞—ë—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç —É –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤:

- **Attack Path Analysis** ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—É—Ç—å ¬´–∫–∞–∫ —Ö–∞–∫–µ—Ä –ø–æ–ø–∞–¥—ë—Ç –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –∫ —Å–µ—Ä–≤–µ—Ä—É 1–° –∑–∞ 3 —Ö–æ–ø–∞¬ª. –í–∏–∑—É–∞–ª—å–Ω–æ, –Ω–∞ –∫–∞—Ä—Ç–µ, —Å –ø–æ–¥—Å–≤–µ—Ç–∫–æ–π –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞.
- **Blast Radius** ‚Äî ¬´–µ—Å–ª–∏ —ç—Ç–æ—Ç –∫–æ–º–ø—å—é—Ç–µ—Ä –≤–∑–ª–æ–º–∞–Ω, –ø–æ–¥ —É–≥—Ä–æ–∑–æ–π –µ—â—ë 47 –º–∞—à–∏–Ω, –≤–∫–ª—é—á–∞—è –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –¥–æ–º–µ–Ω–∞ –∏ –±–∞–∑—É CRM¬ª. –°—á–∏—Ç–∞–µ—Ç—Å—è –∑–∞ 2 —Å–µ–∫—É–Ω–¥—ã.
- **Lateral Movement Detection** ‚Äî –µ—Å–ª–∏ –∫—Ç–æ-—Ç–æ –ø–µ—Ä–µ–ø—Ä—ã–≥–∏–≤–∞–µ—Ç —Å –º–∞—à–∏–Ω—ã –Ω–∞ –º–∞—à–∏–Ω—É –≤–Ω—É—Ç—Ä–∏ —Å–µ—Ç–∏ (–∫–∞–∫ —Ä–µ–∞–ª—å–Ω—ã–µ —Ö–∞–∫–µ—Ä—ã), –º—ã —ç—Ç–æ –≤–∏–¥–∏–º –ø–æ –Ω–æ–≤—ã–º —Å–≤—è–∑—è–º –≤ –≥—Ä–∞—Ñ–µ.
- **Baseline** ‚Äî —á–µ—Ä–µ–∑ 24 —á–∞—Å–∞ —Å–∏—Å—Ç–µ–º–∞ –∑–Ω–∞–µ—Ç ¬´–Ω–æ—Ä–º–∞–ª—å–Ω—É—é¬ª –∫–∞—Ä—Ç–∏–Ω—É —Å–≤—è–∑–µ–π. –õ—é–±–∞—è –Ω–æ–≤–∞—è —Å–≤—è–∑—å ‚Äî –ø–æ–≤–æ–¥ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏.

–£ PT NAD —ç—Ç–æ–≥–æ –Ω–µ—Ç. –£ –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ ‚Äî —Ç–µ–º –±–æ–ª–µ–µ. Darktrace —É–º–µ–µ—Ç, –Ω–æ —Å—Ç–æ–∏—Ç –æ—Ç 15 –º–ª–Ω/–≥–æ–¥ –∏ —É—à—ë–ª –∏–∑ –†–æ—Å—Å–∏–∏.

### 2. AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç ‚Äî –æ–±—ä—è—Å–Ω—è–µ—Ç –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã –±–µ–∑ SOC-–∞–Ω–∞–ª–∏—Ç–∏–∫–∞

–¢–∏–ø–∏—á–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞: —Å–∏—Å—Ç–µ–º–∞ –Ω–∞—à–ª–∞ —É–≥—Ä–æ–∑—É, –ø–æ–∫–∞–∑–∞–ª–∞ –∞–ª–µ—Ä—Ç –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º —Å —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º–∏ –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç—è–º–∏. –ò–ë-—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç (–∞ —á–∞—Å—Ç–æ –ø—Ä–æ—Å—Ç–æ IT-—à–Ω–∏–∫) –¥–æ–ª–∂–µ–Ω —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è —á—Ç–æ —ç—Ç–æ, –Ω–∞—Å–∫–æ–ª—å–∫–æ –æ–ø–∞—Å–Ω–æ –∏ —á—Ç–æ –¥–µ–ª–∞—Ç—å. –ù–∞ —ç—Ç–æ —É—Ö–æ–¥—è—Ç —á–∞—Å—ã.

–ù–∞—à AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç:
- –ü–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞ + –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏–∑ –≥—Ä–∞—Ñ–∞ —Å–µ—Ç–∏ (–∫–∞–∫–∏–µ —Ö–æ—Å—Ç—ã –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã, –ø—É—Ç–∏, blast radius)
- –û–±—ä—è—Å–Ω—è–µ—Ç –Ω–∞ —Ä—É—Å—Å–∫–æ–º: ¬´–ß—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ ‚Üí –ü–æ—á–µ–º—É –æ–ø–∞—Å–Ω–æ ‚Üí –ß—Ç–æ –¥–µ–ª–∞—Ç—å –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å ‚Üí –ö–∞–∫ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å¬ª
- –û—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã: ¬´–ü–æ–∫–∞–∂–∏ blast radius –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ –¥–æ–º–µ–Ω–∞¬ª, ¬´–ö–∞–∫ —É–º–µ–Ω—å—à–∏—Ç—å –∑–æ–Ω—É –ø–æ—Ä–∞–∂–µ–Ω–∏—è?¬ª
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –≥–æ—Ç–æ–≤—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ —Å–µ—Ç–∏

–ù–∏ –æ–¥–∏–Ω NDR-–ø—Ä–æ–¥—É–∫—Ç –Ω–∞ —Ä–æ—Å—Å–∏–π—Å–∫–æ–º —Ä—ã–Ω–∫–µ —ç—Ç–æ–≥–æ –Ω–µ —É–º–µ–µ—Ç. Positive Technologies —Ç–æ–ª—å–∫–æ –∏—Å—Å–ª–µ–¥—É–µ—Ç LLM –¥–ª—è SIEM (–Ω–µ –¥–ª—è NDR), –∏ —Å–∞–º–∏ –Ω–∞–∑—ã–≤–∞—é—Ç —ç—Ç–æ ¬´–ø–µ—Ä–≤—ã–º–∏ —à–∞–≥–∞–º–∏¬ª.

### 3. –ü—Ä–æ—Å—Ç–æ—Ç–∞ ‚Äî —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞ 30 –º–∏–Ω—É—Ç, —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞ 24 —á–∞—Å–∞

- –û–¥–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ ‚Äî —Å–µ–Ω—Å–æ—Ä –ø–æ–¥–Ω–∏–º–∞–µ—Ç—Å—è
- Docker ‚Äî –Ω–∏—á–µ–≥–æ –Ω–µ –Ω—É–∂–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å —Ä—É–∫–∞–º–∏
- –í—Ç–æ—Ä–æ–π —Å–µ–Ω—Å–æ—Ä –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è —Ç–∞–∫ –∂–µ ‚Äî —Å–µ—Ä–≤–µ—Ä –µ–≥–æ –Ω–∞—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –ù–µ –Ω—É–∂–µ–Ω –∏–Ω—Ç–µ–≥—Ä–∞—Ç–æ—Ä, –Ω–µ –Ω—É–∂–µ–Ω –ø—É—Å–∫–æ-–Ω–∞–ª–∞–¥—á–∏–∫

### 4. –¶–µ–Ω–∞ ‚Äî –≤ 5-10 —Ä–∞–∑ –¥–µ—à–µ–≤–ª–µ enterprise-—Ä–µ—à–µ–Ω–∏–π

| –†–µ—à–µ–Ω–∏–µ | –¶–µ–Ω–∞/–≥–æ–¥ | –ù—É–∂–µ–Ω SOC? |
|---------|----------|------------|
| PT NAD | 5-20 –º–ª–Ω —Ä—É–± | –î–∞ |
| Darktrace | 15-30 –º–ª–Ω —Ä—É–± | –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ |
| Kaspersky KATA | 3-10 –º–ª–Ω —Ä—É–± | –î–∞ |
| **NDR-lite Pro** | **0.8-2.4 –º–ª–Ω —Ä—É–±** | **–ù–µ—Ç** |
| NDR-lite Free | 0 | –ù–µ—Ç |

### 5. "–ß—Ç–æ –µ—Å–ª–∏?" ‚Äî —Å–∏–º—É–ª—è—Ü–∏—è –∞—Ç–∞–∫ –Ω–∞ –≥—Ä–∞—Ñ–µ

–£–Ω–∏–∫–∞–ª—å–Ω–∞—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å, —É—Ä–æ–≤–µ–Ω—å XM Cyber / Darktrace ($100k+/–≥–æ–¥). –ö–ª–∏–∫ –ø–æ –ª—é–±–æ–º—É —Ö–æ—Å—Ç—É ‚Üí ¬´Simulate compromise¬ª ‚Üí —Å–∏—Å—Ç–µ–º–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç blast radius, –≤—Å–µ –ø—É—Ç–∏ –¥–æ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –∞–∫—Ç–∏–≤–æ–≤, estimated timeline. –í—Ç–æ—Ä–æ–π –∫–ª–∏–∫: ¬´–ê –µ—Å–ª–∏ –∑–∞–∫—Ä—ã—Ç—å —ç—Ç–æ—Ç –ø–æ—Ä—Ç?¬ª ‚Üí –ø–µ—Ä–µ—Å—á—ë—Ç, –≤–∏–∑—É–∞–ª—å–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ before/after. –û–±–æ—Å–Ω–æ–≤—ã–≤–∞–µ—Ç –±—é–¥–∂–µ—Ç –Ω–∞ –ò–ë –æ–¥–Ω–æ–π –∫–∞—Ä—Ç–∏–Ω–∫–æ–π.

### 6. Telegram-–±–æ—Ç ‚Äî –∞–ª–µ—Ä—Ç—ã –≤ —Ç–µ–ª–µ—Ñ–æ–Ω –≤ 3 –Ω–æ—á–∏

PT NAD —à–ª—ë—Ç email. Email –≤ 3 –Ω–æ—á–∏ –Ω–∏–∫—Ç–æ –Ω–µ —á–∏—Ç–∞–µ—Ç. –ú—ã —à–ª—ë–º –≤ Telegram —Å –∫–Ω–æ–ø–∫–∞–º–∏ –¥–µ–π—Å—Ç–≤–∏–π. –î–ª—è –ò–ë-—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞ –∫–æ—Ç–æ—Ä—ã–π –æ–¥–∏–Ω –Ω–∞ –∫–æ–º–ø–∞–Ω–∏—é ‚Äî —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ.

### 7. Compliance-–æ—Ç—á—ë—Ç—ã –∑–∞ –∫–Ω–æ–ø–∫—É

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∞–∫—Ç–æ–≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏–∏ (187-–§–ó), —Å—Ö–µ–º –ø–æ—Ç–æ–∫–æ–≤ (–ì–û–°–¢ 57580), –∂—É—Ä–Ω–∞–ª–æ–≤ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤. AI –ø–∏—à–µ—Ç —Ç–µ–∫—Å—Ç, –≥—Ä–∞—Ñ –¥–∞—ë—Ç –¥–∞–Ω–Ω—ã–µ. –ö–æ–Ω—Å–∞–ª—Ç–µ—Ä—ã –±–µ—Ä—É—Ç –∑–∞ —ç—Ç–æ 500–∫-2–ú. –ú—ã ‚Äî –Ω–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É.

### 8. Active Directory ‚Äî –∏–º–µ–Ω–∞ –≤–º–µ—Å—Ç–æ IP-–∞–¥—Ä–µ—Å–æ–≤

–° AD-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π –∞–ª–µ—Ä—Ç –Ω–µ ¬´10.0.1.45 ‚Üí 10.0.0.1¬ª, –∞ ¬´–ú–∞—Ä–∏–Ω–∞ –ò–≤–∞–Ω–æ–≤–∞ –∏–∑ –±—É—Ö–≥–∞–ª—Ç–µ—Ä–∏–∏ –ø—ã—Ç–∞–µ—Ç—Å—è –ø–æ–ø–∞—Å—Ç—å –Ω–∞ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –¥–æ–º–µ–Ω–∞¬ª. AI –æ–±—ä—è—Å–Ω—è–µ—Ç –∏–Ω—Ü–∏–¥–µ–Ω—Ç —Å –∏–º–µ–Ω–∞–º–∏ –ª—é–¥–µ–π –∏ –æ—Ç–¥–µ–ª–æ–≤.

---

## ‚ö° –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ —á–µ—Å—Ç–Ω—ã–µ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏

–¢–æ, —á—Ç–æ –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å, —á—Ç–æ–±—ã –Ω–µ –æ–±–µ—â–∞—Ç—å –ª–∏—à–Ω–µ–≥–æ:

**1. –ú—ã –Ω–µ –∑–∞–º–µ–Ω—è–µ–º PT NAD –¥–ª—è –∫—Ä—É–ø–Ω–æ–≥–æ enterprise**

–£ PT NAD ‚Äî 10 –ª–µ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏, 86 —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–µ–º—ã—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤, —Å–≤–æ—è –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è (PT ESC), –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª –¥–≤–∞–∂–¥—ã –≤ –Ω–µ–¥–µ–ª—é, —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –§–°–¢–≠–ö. –ú—ã —Å –Ω–∏–º–∏ –Ω–µ –∫–æ–Ω–∫—É—Ä–∏—Ä—É–µ–º –Ω–∞–ø—Ä—è–º—É—é ‚Äî —É –Ω–∞—Å –¥—Ä—É–≥–æ–π —Å–µ–≥–º–µ–Ω—Ç.

**2. –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –§–°–¢–≠–ö –Ω–∞ —Å—Ç–∞—Ä—Ç–µ –Ω–µ—Ç**

–î–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏—Ö –∫–æ–º–ø–∞–Ω–∏–π —ç—Ç–æ –Ω–µ –±–ª–æ–∫–µ—Ä (–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ä–µ–µ—Å—Ç—Ä–∞ –†–ü–û). –ù–æ –¥–ª—è —Ä—è–¥–∞ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º –∏ –æ–±—ä–µ–∫—Ç–æ–≤ –ö–ò–ò –≤—ã—Å–æ–∫–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ‚Äî –§–°–¢–≠–ö –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω. –ü–ª–∞–Ω–∏—Ä—É–µ–º –Ω–∞ v2.

**3. –ë–∞–∑–∞ –ø—Ä–∞–≤–∏–ª –¥–µ—Ç–µ–∫—Ü–∏–∏ –º–µ–Ω—å—à–µ, —á–µ–º —É PT NAD**

–ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ç–∫—Ä—ã—Ç—ã–µ –ø—Ä–∞–≤–∏–ª–∞ ET Open + —Å–≤–æ–∏ 20 –ø—Ä–∞–≤–∏–ª (–≤–∫–ª—é—á–∞—è 5 –≥—Ä–∞—Ñ–æ–≤—ã—Ö, 2 AD-based, JA3 fingerprinting). PT NAD –∏–º–µ–µ—Ç —Ç—ã—Å—è—á–∏ –ø—Ä–æ–ø—Ä–∏–µ—Ç–∞—Ä–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª –æ—Ç PT ESC. –ù–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ: –¥–ª—è —Ç–∏–ø–æ–≤—ã—Ö –∞—Ç–∞–∫ (brute-force, lateral movement, C2, DNS-—Ç—É–Ω–Ω–µ–ª–∏, —ç–∫—Å—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è) –Ω–∞—à–∏—Ö –ø—Ä–∞–≤–∏–ª –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ. –≠–∫–∑–æ—Ç–∏–∫—É –º–æ–∂–µ–º –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å.

**4. –ù–µ —Ö—Ä–∞–Ω–∏–º —Å—ã—Ä–æ–π —Ç—Ä–∞—Ñ–∏–∫ (–∫–æ–ø–∏–∏ –ø–∞–∫–µ—Ç–æ–≤)**

PT NAD —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç PCAP ‚Äî –º–æ–∂–Ω–æ ¬´–ø–µ—Ä–µ–º–æ—Ç–∞—Ç—å¬ª –∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å–µ—Å—Å–∏–∏. –ú—ã —Ö—Ä–∞–Ω–∏–º –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (–∫—Ç–æ, –∫—É–¥–∞, –∫–æ–≥–¥–∞, —Å–∫–æ–ª—å–∫–æ –±–∞–π—Ç) + –∞–ª–µ—Ä—Ç—ã. –î–ª—è 95% —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π —ç—Ç–æ–≥–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ. –ü–æ–ª–Ω—ã–π PCAP ‚Äî –≤ roadmap.

**5. –ù–µ—Ç —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã**

PT NAD —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Å–≤—è–∑–∫–µ —Å MaxPatrol SIEM, PT Sandbox, PT AF. –£ –Ω–∞—Å ‚Äî standalone –ø—Ä–æ–¥—É–∫—Ç. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –ø–æ–ø—É–ª—è—Ä–Ω—ã–º–∏ SIEM (–ø–æ syslog/CEF) ‚Äî –≤ –ø–ª–∞–Ω–µ, –Ω–æ –ø–æ–∫–∞ –Ω–µ—Ç.

**6. –®–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç—Ä–∞—Ñ–∏–∫**

–ö–∞–∫ –∏ –ª—é–±–æ–π –ø–∞—Å—Å–∏–≤–Ω—ã–π NDR, –º—ã –Ω–µ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ–º TLS. –†–∞–±–æ—Ç–∞–µ–º —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏ (SNI, certificate info, –æ–±—ä—ë–º—ã, timing). –î–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –Ω—É–∂–µ–Ω TLS-—Ç–µ—Ä–º–∏–Ω–∞—Ç–æ—Ä –ø–µ—Ä–µ–¥ —Å–µ–Ω—Å–æ—Ä–æ–º ‚Äî Enterprise-—Ñ–∏—á–∞.

---

## üìä –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Å –∞–Ω–∞–ª–æ–≥–∞–º–∏

### PT Network Attack Discovery (PT NAD) ‚Äî –≥–ª–∞–≤–Ω—ã–π –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç

–ü—Ä—è–º–æ–π –∞–Ω–∞–ª–æ–≥, –ª–∏–¥–µ—Ä —Ä–æ—Å—Å–∏–π—Å–∫–æ–≥–æ —Ä—ã–Ω–∫–∞ NDR. –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Å 2015 –≥–æ–¥–∞, –≤—Ö–æ–¥–∏—Ç –≤ —ç–∫–æ—Å–∏—Å—Ç–µ–º—É Positive Technologies.

| | PT NAD | NDR-lite |
|---|--------|----------|
| **–¶–µ–ª–µ–≤–æ–π –∫–ª–∏–µ–Ω—Ç** | Enterprise, –∫—Ä—É–ø–Ω—ã–π –±–∏–∑–Ω–µ—Å, SOC-–∫–æ–º–∞–Ω–¥—ã | –°–ú–ë, —Å—Ä–µ–¥–Ω–∏–π –±–∏–∑–Ω–µ—Å, 1-2 –ò–ë-—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞ |
| **–¶–µ–Ω–∞** | –æ—Ç 5 –º–ª–Ω —Ä—É–±/–≥–æ–¥ | –æ—Ç 0 (free) –¥–æ 2.4 –º–ª–Ω —Ä—É–±/–≥–æ–¥ |
| **–£—Å—Ç–∞–Ω–æ–≤–∫–∞** | –ü—Ä–æ–µ–∫—Ç, –∏–Ω—Ç–µ–≥—Ä–∞—Ç–æ—Ä, –¥–Ω–∏-–Ω–µ–¥–µ–ª–∏ | 1 –∫–æ–º–∞–Ω–¥–∞, 30 –º–∏–Ω—É—Ç |
| **–°–∏–≥–Ω–∞—Ç—É—Ä–Ω—ã–π IDS** | ‚úÖ –°–≤–æ–π –¥–≤–∏–∂–æ–∫, PT ESC –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è 2—Ä/–Ω–µ–¥ | ‚úÖ Suricata + ET Open |
| **ML/–ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑** | ‚úÖ –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π (DGA, –∞–Ω–æ–º–∞–ª–∏–∏, –ø—Ä–æ—Ñ–∏–ª–∏) | ‚úÖ –ë–∞–∑–æ–≤—ã–π (Isolation Forest, baseline) |
| **–ü–∞—Ä—Å–∏–Ω–≥ –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤** | 86 –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤, 30 –Ω–∞ L7 | ~30 (Zeek) + Suricata |
| **–ì—Ä–∞—Ñ–æ–≤–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞** | ‚ùå –ù–µ—Ç (—Ç–æ–ª—å–∫–æ —Å–≤—è–∑–∏ –¥–ª—è NTLM relay) | ‚úÖ –ü–æ–ª–Ω—ã–π –≥—Ä–∞—Ñ, attack paths, blast radius |
| **LLM-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç** | ‚ùå –ù–µ—Ç (–∏—Å—Å–ª–µ–¥—É—é—Ç –¥–ª—è SIEM) | ‚úÖ –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π, —Å –≥—Ä–∞—Ñ–æ–≤—ã–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º |
| **Attack path analysis** | ‚ùå | ‚úÖ |
| **Blast radius** | ‚ùå | ‚úÖ |
| **Risk scoring –Ω–∞ –≥—Ä–∞—Ñ–µ** | ‚ùå | ‚úÖ |
| **–•—Ä–∞–Ω–µ–Ω–∏–µ PCAP** | ‚úÖ | ‚ùå (–º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ) |
| **–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –§–°–¢–≠–ö** | ‚úÖ | ‚ùå (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è v2) |
| **–†–µ–µ—Å—Ç—Ä —Ä–æ—Å—Å–∏–π—Å–∫–æ–≥–æ –ü–û** | ‚úÖ | ‚è≥ (–ø–æ–¥–∞—á–∞ –ø–æ—Å–ª–µ MVP) |
| **–≠–∫–æ—Å–∏—Å—Ç–µ–º–∞** | ‚úÖ (SIEM, Sandbox, AF) | ‚ùå Standalone |
| **–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≥—Ä–∞—Ñ —Å–µ—Ç–∏** | –ß–∞—Å—Ç–∏—á–Ω–æ (–∫–∞—Ä—Ç–∞ —Ö–æ—Å—Ç–æ–≤) | ‚úÖ –ü–æ–ª–Ω—ã–π (Cytoscape.js) |
| **–°–∏–º—É–ª—è—Ü–∏—è –∞—Ç–∞–∫ "–ß—Ç–æ –µ—Å–ª–∏?"** | ‚ùå | ‚úÖ Compromise + mitigation simulation |
| **Segmentation Score** | ‚ùå | ‚úÖ 0-100, –µ–∂–µ–¥–Ω–µ–≤–Ω–æ, —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏ |
| **Telegram-–±–æ—Ç** | ‚ùå (email) | ‚úÖ –° –∫–Ω–æ–ø–∫–∞–º–∏ –¥–µ–π—Å—Ç–≤–∏–π |
| **Compliance-–æ—Ç—á—ë—Ç—ã** | ‚ùå | ‚úÖ 187-–§–ó, –ì–û–°–¢ 57580, –∞–≤—Ç–æ-–≥–µ–Ω–µ—Ä–∞—Ü–∏—è |
| **AD-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** | ‚úÖ | ‚úÖ –ò–º–µ–Ω–∞, –æ—Ç–¥–µ–ª—ã, –≥—Ä—É–ø–ø—ã –≤ –∞–ª–µ—Ä—Ç–∞—Ö |
| **JA3/JA4 fingerprinting** | ‚úÖ | ‚úÖ + baseline per host |
| **SIEM export (Syslog/CEF)** | ‚úÖ | ‚úÖ CEF, Syslog, JSON |
| **Threat Intelligence** | ‚úÖ PT ESC –ø—Ä–æ–ø—Ä–∏–µ—Ç–∞—Ä–Ω—ã–π | ‚úÖ abuse.ch (–±–µ—Å–ø–ª–∞—Ç–Ω–æ) + STIX/TAXII (–§–∏–Ω–¶–ï–†–¢, –ì–æ—Å–°–û–ü–ö–ê) |
| **–ù—É–∂–µ–Ω SOC?** | –î–∞ | –ù–µ—Ç |

**–í—ã–≤–æ–¥ –¥–ª—è –ø—Ä–æ–¥–∞–∂–Ω–∏–∫–æ–≤:** PT NAD —Å–∏–ª—å–Ω–µ–µ –≤ –≥–ª—É–±–∏–Ω–µ –∞–Ω–∞–ª–∏–∑–∞ –∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏. –ú—ã —Å–∏–ª—å–Ω–µ–µ –≤ –≥—Ä–∞—Ñ–æ–≤–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–µ, AI, –ø—Ä–æ—Å—Ç–æ—Ç–µ –∏ —Ü–µ–Ω–µ. –≠—Ç–æ –†–ê–ó–ù–´–ï —Å–µ–≥–º–µ–Ω—Ç—ã —Ä—ã–Ω–∫–∞. –ù–∞—à –∫–ª–∏–µ–Ω—Ç ‚Äî —Ç–æ—Ç, –∫–æ–º—É PT NAD –Ω–µ –ø–æ –∫–∞—Ä–º–∞–Ω—É.

### Kaspersky Anti Targeted Attack (KATA)

–ö–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ—Ç–∏–≤ —Ü–µ–ª–µ–≤—ã—Ö –∞—Ç–∞–∫. –í–∫–ª—é—á–∞–µ—Ç NDR-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç, sandbox –¥–ª—è —Ñ–∞–π–ª–æ–≤ –∏ endpoint-–∞–≥–µ–Ω—Ç (KEDR). –ù–µ —á–∏—Å—Ç—ã–π NDR ‚Äî —Å–∫–æ—Ä–µ–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ anti-APT.

| | KATA | NDR-lite |
|---|------|----------|
| **–¶–µ–Ω–∞** | 3-10 –º–ª–Ω —Ä—É–±/–≥–æ–¥ (–ø–æ–ª–Ω—ã–π –∫–æ–º–ø–ª–µ–∫—Ç 5-8 –º–ª–Ω) | 0-2.4 –º–ª–Ω —Ä—É–±/–≥–æ–¥ |
| **–§–æ–∫—É—Å** | APT: sandbox + endpoint + —Å–µ—Ç—å | –°–µ—Ç–µ–≤–æ–π —Ç—Ä–∞—Ñ–∏–∫ + –≥—Ä–∞—Ñ + AI |
| **NDR-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç** | –ï—Å—Ç—å, –Ω–æ –Ω–µ –æ—Å–Ω–æ–≤–Ω–æ–π | Core |
| **Sandbox (–∞–Ω–∞–ª–∏–∑ —Ñ–∞–π–ª–æ–≤)** | ‚úÖ –°–∏–ª—å–Ω–µ–π—à–∏–π –≤ –†–§ | ‚ùå |
| **Endpoint-–∞–≥–µ–Ω—Ç (KEDR)** | ‚úÖ –ü—Ä–æ—Ü–µ—Å—Å—ã, —Ñ–∞–π–ª—ã, —Ä–µ–µ—Å—Ç—Ä | ‚ùå |
| **ML** | ‚úÖ –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π (KSN, –º–ª—Ä–¥ –æ–±—Ä–∞–∑—Ü–æ–≤) | ‚úÖ –ë–∞–∑–æ–≤—ã–π (Isolation Forest) |
| **–ì—Ä–∞—Ñ–æ–≤–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞** | ‚ùå | ‚úÖ (attack paths, blast radius) |
| **LLM-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç** | ‚ùå | ‚úÖ (–ª–æ–∫–∞–ª—å–Ω—ã–π –∏–ª–∏ API) |
| **–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞ —Å–µ—Ç–∏** | ‚ùå | ‚úÖ (Cytoscape.js) |
| **–°–∏–º—É–ª—è—Ü–∏—è –∞—Ç–∞–∫** | ‚ùå | ‚úÖ "–ß—Ç–æ –µ—Å–ª–∏?" –Ω–∞ –≥—Ä–∞—Ñ–µ |
| **Telegram-–±–æ—Ç** | ‚ùå | ‚úÖ |
| **Compliance-–æ—Ç—á—ë—Ç—ã** | ‚ùå | ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ |
| **–ù—É–∂–µ–Ω SOC?** | –î–∞ | –ù–µ—Ç |
| **–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** | ‚úÖ –§–°–¢–≠–ö | ‚ùå (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è) |
| **–£—Å—Ç–∞–Ω–æ–≤–∫–∞** | –ü—Ä–æ–µ–∫—Ç —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ç–æ—Ä–æ–º + —Ä–∞—Å–∫–∞—Ç–∫–∞ –∞–≥–µ–Ω—Ç–æ–≤ | 1 –∫–æ–º–∞–Ω–¥–∞, 30 –º–∏–Ω—É—Ç |

**–ì–¥–µ KATA —Ä–µ–∞–ª—å–Ω–æ —Å–∏–ª—å–Ω–µ–µ:** sandbox –¥–ª—è —Ñ–∞–π–ª–æ–≤ (–ª–æ–≤–∏—Ç –≤—Ä–µ–¥–æ–Ω–æ—Å—ã –ø–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É), endpoint-–≤–∏–¥–∏–º–æ—Å—Ç—å (–ø—Ä–æ—Ü–µ—Å—Å—ã, —Ä–µ–µ—Å—Ç—Ä), ML –Ω–∞ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö KSN.

**–ì–¥–µ –º—ã —Å–∏–ª—å–Ω–µ–µ:** –≥—Ä–∞—Ñ–æ–≤–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞, AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç, —Ü–µ–Ω–∞ (–≤ 3-5 —Ä–∞–∑ –¥–µ—à–µ–≤–ª–µ), –Ω–µ –Ω—É–∂–µ–Ω SOC, –ø—Ä–æ—Å—Ç–æ—Ç–∞.

**–ú–æ–≥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤ —Å–≤—è–∑–∫–µ:** KATA –ª–æ–≤–∏—Ç –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π —Ñ–∞–π–ª, NDR-lite –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞–∫ –æ–Ω —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ —Å–µ—Ç–∏ –∏ –∫–∞–∫–æ–π blast radius.

**–í—ã–≤–æ–¥:** KATA ‚Äî –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç APT (—Ñ–∞–π–ª—ã + endpoint). NDR-lite ‚Äî –¥–ª—è –≤–∏–¥–∏–º–æ—Å—Ç–∏ —Å–µ—Ç–∏ (–≥—Ä–∞—Ñ + AI). –†–∞–∑–Ω—ã–µ –∑–∞–¥–∞—á–∏, —Ä–∞–∑–Ω—ã–µ –±—é–¥–∂–µ—Ç—ã.

### Solar JSOC (–†–æ—Å—Ç–µ–ª–µ–∫–æ–º-–°–æ–ª–∞—Ä)

| | Solar JSOC | NDR-lite |
|---|-----------|----------|
| **–¢–∏–ø** | –£—Å–ª—É–≥–∞ (SOC-as-a-service) | –ü—Ä–æ–¥—É–∫—Ç (on-premise) |
| **–¶–µ–Ω–∞** | –æ—Ç 3 –º–ª–Ω —Ä—É–±/–≥–æ–¥ | 0-2.4 –º–ª–Ω —Ä—É–±/–≥–æ–¥ |
| **–î–∞–Ω–Ω—ã–µ** | –£—Ö–æ–¥—è—Ç –≤ –æ–±–ª–∞–∫–æ –°–æ–ª–∞—Ä–∞ | –û—Å—Ç–∞—é—Ç—Å—è —É –∫–ª–∏–µ–Ω—Ç–∞ |
| **–ö–æ–Ω—Ç—Ä–æ–ª—å** | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π | –ü–æ–ª–Ω—ã–π |

**–í—ã–≤–æ–¥:** –î–ª—è —Ç–µ—Ö, –∫–æ–º—É –≤–∞–∂–Ω–æ —á—Ç–æ–±—ã –¥–∞–Ω–Ω—ã–µ –æ—Å—Ç–∞–≤–∞–ª–∏—Å—å –≤–Ω—É—Ç—Ä–∏ ‚Äî –º—ã –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ –ª—É—á—à–µ.

### Darktrace (—É—à–ª–∏ –∏–∑ –†–§)

–ë–ª–∏–∂–∞–π—à–∏–π –∏–¥–µ–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–æ–≥ ‚Äî —Ç–æ–∂–µ —Å—Ç—Ä–æ–∏—Ç ¬´–∏–º–º—É–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É¬ª —Å–µ—Ç–∏ —Å ML –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π.

| | Darktrace | NDR-lite |
|---|-----------|----------|
| **–¶–µ–Ω–∞** | 15-30 –º–ª–Ω —Ä—É–±/–≥–æ–¥ | 0-2.4 –º–ª–Ω —Ä—É–±/–≥–æ–¥ |
| **–ì—Ä–∞—Ñ–æ–≤–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞** | ‚úÖ –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è (–∑–∞–∫—Ä—ã—Ç–∞—è) | ‚úÖ (–æ—Ç–∫—Ä—ã—Ç–∞—è, Dgraph) |
| **LLM-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç** | ‚ùå | ‚úÖ |
| **–î–æ—Å—Ç—É–ø–µ–Ω –≤ –†–§** | ‚ùå –£—à–ª–∏ | ‚úÖ |
| **On-premise** | –û–±–ª–∞–∫–æ | ‚úÖ |

**–í—ã–≤–æ–¥:** Darktrace ‚Äî —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –æ—Ä–∏–µ–Ω—Ç–∏—Ä. –ú—ã –¥–∞—ë–º 70% –∏—Ö —Ü–µ–Ω–Ω–æ—Å—Ç–∏ –∑–∞ 10% —Ü–µ–Ω—ã. –ò –º—ã –¥–æ—Å—Ç—É–ø–Ω—ã –≤ –†–æ—Å—Å–∏–∏.

### –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã (Suricata, Zeek, Security Onion)

| | Suricata + Zeek + ELK | NDR-lite |
|---|----------------------|----------|
| **–¶–µ–Ω–∞** | 0 (–Ω–æ –Ω—É–∂–Ω—ã –ª—é–¥–∏) | 0 (free) ‚Äî 2.4 –º–ª–Ω |
| **–í—Ä–µ–º—è –¥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞** | –ù–µ–¥–µ–ª–∏-–º–µ—Å—è—Ü—ã | 24 —á–∞—Å–∞ |
| **–ù—É–∂–Ω–∞ —ç–∫—Å–ø–µ—Ä—Ç–∏–∑–∞** | –í—ã—Å–æ–∫–∞—è | –ù–∏–∑–∫–∞—è |
| **–ì—Ä–∞—Ñ–æ–≤–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞** | ‚ùå | ‚úÖ |
| **LLM-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç** | ‚ùå | ‚úÖ |
| **–ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è** | –†—É—á–Ω–∞—è | 20 –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª |
| **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è** | –¢–∞–±–ª–∏—Ü—ã, —Å–ø–∏—Å–∫–∏ | –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≥—Ä–∞—Ñ |
| **–û—Ç—á—ë—Ç—ã** | –†—É—á–Ω—ã–µ | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ PDF + compliance |
| **Telegram-–±–æ—Ç** | ‚ùå | ‚úÖ |
| **–°–∏–º—É–ª—è—Ü–∏—è –∞—Ç–∞–∫** | ‚ùå | ‚úÖ "–ß—Ç–æ –µ—Å–ª–∏?" |
| **AD-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** | ‚ùå | ‚úÖ |

**–í—ã–≤–æ–¥:** –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º Suricata –∏ Zeek –≤–Ω—É—Ç—Ä–∏. –î–æ–±–∞–≤–ª—è–µ–º —Å–≤–µ—Ä—Ö—É –≥—Ä–∞—Ñ, AI, –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é –∏ –ø—Ä–µ–≤—Ä–∞—â–∞–µ–º –Ω–∞–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –≤ –≥–æ—Ç–æ–≤—ã–π –ø—Ä–æ–¥—É–∫—Ç.

### –ò—Ç–æ–≥–æ–≤–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

```
                    –¶–µ–Ω–∞ ‚Üë
                    
     30 –º–ª–Ω ‚î§  Darktrace (—É—à–ª–∏ –∏–∑ –†–§)
             ‚îÇ
     15 –º–ª–Ω ‚î§
             ‚îÇ
     10 –º–ª–Ω ‚î§                      KATA
             ‚îÇ
      5 –º–ª–Ω ‚î§         PT NAD
             ‚îÇ         (enterprise, –Ω–µ—Ç –≥—Ä–∞—Ñ–∞,
      2 –º–ª–Ω ‚î§          –Ω–µ—Ç LLM)         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
             ‚îÇ                           ‚îÇ  NDR-lite   ‚îÇ
      1 –º–ª–Ω ‚î§                           ‚îÇ  Pro        ‚îÇ
             ‚îÇ                           ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         0  ‚î§  Suricata+Zeek (DIY)      NDR-lite Free
             ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
                 –°–ª–æ–∂–Ω–æ—Å—Ç—å / –ü–æ—Ä–æ–≥ –≤—Ö–æ–¥–∞ ‚Üí
```

**–ù–∞—à–∞ –Ω–∏—à–∞:** –º–∞–∫—Å–∏–º—É–º —Ü–µ–Ω–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –º–∏–Ω–∏–º—É–º–µ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –∏ —Å—Ä–µ–¥–Ω–µ–π —Ü–µ–Ω–µ. –ó–¥–µ—Å—å —Å–µ–π—á–∞—Å –ü–£–°–¢–û ‚Äî –Ω–∏ –æ–¥–Ω–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞.

### –ì–ª–∞–≤–Ω—ã–π —Ç–µ–∑–∏—Å

–ú—ã –Ω–µ –∫–æ–Ω–∫—É—Ä–∏—Ä—É–µ–º —Å PT NAD. –ú—ã –∫–æ–Ω–∫—É—Ä–∏—Ä—É–µ–º —Å **–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ–º —Ä–µ—à–µ–Ω–∏—è**. –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∫–æ–º–ø–∞–Ω–∏–π —Å—Ä–µ–¥–Ω–µ–≥–æ –±–∏–∑–Ω–µ—Å–∞ —Å–µ–π—á–∞—Å –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç NDR –≤–æ–æ–±—â–µ, –ø–æ—Ç–æ–º—É —á—Ç–æ PT NAD –Ω–µ –ø–æ –∫–∞—Ä–º–∞–Ω—É. –ù–∞—à —Ä–µ–∞–ª—å–Ω—ã–π –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç ‚Äî ¬´–∞–≤–æ—Å—å –ø—Ä–æ–Ω–µ—Å—ë—Ç¬ª.

---

## üéØ –¶–µ–ª–µ–≤–æ–π —Ä—ã–Ω–æ–∫

### –ü–µ—Ä–≤–∏—á–Ω–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è

**–°—Ä–µ–¥–Ω–∏–π –±–∏–∑–Ω–µ—Å 100-1000 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤:**
- –ë–∞–Ω–∫–∏ –∏ —Ñ–∏–Ω—Ç–µ—Ö (—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –¶–ë, 187-–§–ó)
- –ü—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã–µ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è (–ö–ò–ò)
- –†–∏—Ç–µ–π–ª (PCI DSS, –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)
- IT-–∫–æ–º–ø–∞–Ω–∏–∏ –∏ —Ö–æ—Å—Ç–∏–Ω–≥–∏
- –ú–µ–¥–∏—Ü–∏–Ω–∞ (–ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, 187-–§–ó)

**–ü—Ä–∏–∑–Ω–∞–∫–∏ –∏–¥–µ–∞–ª—å–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞:**
- 1-2 —á–µ–ª–æ–≤–µ–∫–∞ –Ω–∞ –ò–ë (–∏–ª–∏ —Å–æ–≤–º–µ—â–∞—é—Ç —Å IT)
- –ù–µ—Ç SIEM –∏–ª–∏ –µ—Å—Ç—å –±–∞–∑–æ–≤—ã–π (Splunk Free, ELK)
- –ë—é–¥–∂–µ—Ç –Ω–∞ –ò–ë: 1-5 –º–ª–Ω —Ä—É–±/–≥–æ–¥
- –ë—ã–ª–∏ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã –∏–ª–∏ –∞—É–¥–∏—Ç –ø–æ–∫–∞–∑–∞–ª –ø—Ä–æ–±–ª–µ–º—ã
- –£—Ö–æ–¥—è—â–∏–π –∏–Ω–æ—Å—Ç—Ä–∞–Ω–Ω—ã–π –≤–µ–Ω–¥–æ—Ä

### TAM/SAM/SOM

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|---------|----------|
| TAM (–†–æ—Å—Å–∏—è, –°–ú–ë + –ö–ò–ò) | ~55 000 –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π |
| SAM (–∏–º–µ—é—Ç –±—é–¥–∂–µ—Ç –∏ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å) | ~5 000 –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π |
| SOM (–ø–µ—Ä–≤—ã–π –≥–æ–¥) | 50-100 (free) + 15-30 (paid) |

---

## üìê –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –û–±—â–∞—è —Å—Ö–µ–º–∞

```
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ                WEB UI (React)                    ‚îÇ
                    ‚îÇ  Dashboard ‚îÇ Graph Map ‚îÇ Incidents ‚îÇ AI Chat     ‚îÇ
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                   ‚îÇ REST API / WebSocket
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ          API GATEWAY (Moleculer)                 ‚îÇ
                    ‚îÇ   moleculer-web ‚îÇ auth ‚îÇ rate-limit ‚îÇ ws        ‚îÇ
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                   ‚îÇ NATS (service mesh)
                 ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                 ‚ñº                 ‚ñº                      ‚ñº
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ CORRELATION     ‚îÇ  ‚îÇ GRAPH SERVICE     ‚îÇ    Node.js (Moleculer)
    ‚îÇ Event rules     ‚îÇ  ‚îÇ Dgraph client     ‚îÇ
    ‚îÇ Graph rules     ‚îÇ  ‚îÇ Blast radius      ‚îÇ
    ‚îÇ Risk scorer     ‚îÇ  ‚îÇ Attack paths      ‚îÇ
    ‚îÇ MITRE mapper    ‚îÇ  ‚îÇ Risk scoring      ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
            ‚îÇ                    ‚îÇ
            ‚îÇ                    ‚îÇ            ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
            ‚îÇ                    ‚îÇ            ‚îÇ Python (Pylecular) ‚îÇ
            ‚îÇ           ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ                    ‚îÇ
            ‚îÇ           ‚îÇ     Dgraph       ‚îÇ ‚îÇ ML SERVICE         ‚îÇ
            ‚îÇ           ‚îÇ  (network graph) ‚îÇ ‚îÇ  Isolation Forest  ‚îÇ
            ‚îÇ           ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ  Baseline builder  ‚îÇ
            ‚îÇ                                ‚îÇ  Anomaly scoring   ‚îÇ
            ‚îÇ                                ‚îÇ                    ‚îÇ
            ‚îÇ                                ‚îÇ LLM SERVICE        ‚îÇ
            ‚îÇ                                ‚îÇ  Ollama / Claude / ‚îÇ
            ‚îÇ                                ‚îÇ  YandexGPT/GigaChat‚îÇ
            ‚îÇ                                ‚îÇ  Explain incidents ‚îÇ
            ‚îÇ                                ‚îÇ  Chat assistant    ‚îÇ
            ‚îÇ                                ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
            ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ ClickHouse      ‚îÇ  ‚îÇ   PostgreSQL     ‚îÇ  ‚îÇ   Redis           ‚îÇ
    ‚îÇ (events, alerts)‚îÇ  ‚îÇ  (users, config) ‚îÇ  ‚îÇ  (cache, sessions)‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ≤‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
             ‚îÇ
             ‚îÇ NATS (events stream)
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê        ‚îÇ
    ‚îÇ  ‚îÇ  SENSOR #1   ‚îÇ   ‚îÇ  SENSOR #2   ‚îÇ   ‚îÇ  SENSOR #3   ‚îÇ  ...  ‚îÇ
    ‚îÇ  ‚îÇ  (–ø–µ—Ä–∏–º–µ—Ç—Ä)  ‚îÇ   ‚îÇ (core switch)‚îÇ   ‚îÇ (—Å–µ—Ä–≤–µ—Ä–Ω–∞—è)  ‚îÇ       ‚îÇ
    ‚îÇ  ‚îÇ  Suricata    ‚îÇ   ‚îÇ  Suricata    ‚îÇ   ‚îÇ  Suricata    ‚îÇ       ‚îÇ
    ‚îÇ  ‚îÇ  Zeek        ‚îÇ   ‚îÇ  Zeek        ‚îÇ   ‚îÇ  Zeek        ‚îÇ       ‚îÇ
    ‚îÇ  ‚îÇ  Moleculer   ‚îÇ   ‚îÇ  Moleculer   ‚îÇ   ‚îÇ  Moleculer   ‚îÇ       ‚îÇ
    ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò       ‚îÇ
    ‚îÇ           Auto-discovery —á–µ—Ä–µ–∑ NATS                           ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ü–æ—á–µ–º—É —Ç–∞–∫–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

**Moleculer.js + NATS:** –°–µ–Ω—Å–æ—Ä—ã –∏ —Å–µ—Ä–≤–µ—Ä–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã –æ–±—â–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ —à–∏–Ω—É —Å–æ–±—ã—Ç–∏–π. –ù–æ–≤—ã–π —Å–µ–Ω—Å–æ—Ä –ø–æ–¥–Ω—è–ª—Å—è ‚Äî —Å–µ—Ä–≤–µ—Ä –µ–≥–æ –æ–±–Ω–∞—Ä—É–∂–∏–ª –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. –ö–∞–∂–¥—ã–π —Å–µ—Ä–≤–∏—Å (–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è, –≥—Ä–∞—Ñ, LLM) —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ.

**–ß–µ—Ç—ã—Ä–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ ‚Äî –∫–∞–∂–¥–æ–µ –¥–ª—è —Å–≤–æ–µ–≥–æ:**

| –•—Ä–∞–Ω–∏–ª–∏—â–µ | –ß—Ç–æ —Ö—Ä–∞–Ω–∏—Ç | –ü–æ—á–µ–º—É |
|-----------|-----------|--------|
| **ClickHouse** | –°—ã—Ä—ã–µ —Å–æ–±—ã—Ç–∏—è, –∞–ª–µ—Ä—Ç—ã, –ª–æ–≥–∏ | SQL-–∑–∞–ø—Ä–æ—Å—ã –ø–æ –º–∏–ª–ª–∏–æ–Ω–∞–º —Å–æ–±—ã—Ç–∏–π, —Å–∂–∞—Ç–∏–µ 5-10x, –º–∏–Ω–∏–º—É–º RAM |
| **Dgraph** | –ì—Ä–∞—Ñ —Å–µ—Ç–∏: —Ö–æ—Å—Ç—ã, —Å–≤—è–∑–∏, –¥–æ–º–µ–Ω—ã, baseline | –û–±—Ö–æ–¥ –≥—Ä–∞—Ñ–∞, attack paths, blast radius |
| **PostgreSQL** | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –∫–æ–Ω—Ñ–∏–≥–∏, –æ—Ç—á—ë—Ç—ã | ACID, —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ |
| **Redis** | –ö—ç—à –¥–∞—à–±–æ—Ä–¥–∞, —Å–µ—Å—Å–∏–∏ | –°–∫–æ—Ä–æ—Å—Ç—å |

---

## üîå –°–µ–Ω—Å–æ—Ä–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ö–∞–∫ —Å–Ω–∏–º–∞–µ—Ç—Å—è —Ç—Ä–∞—Ñ–∏–∫

–°–µ–Ω—Å–æ—Ä ‚Äî —ç—Ç–æ –Ω–µ –∞–≥–µ–Ω—Ç –Ω–∞ –∫–∞–∂–¥–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ. –û–Ω —Å–ª—É—à–∞–µ—Ç –∑–µ—Ä–∫–∞–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç—Ä–∞—Ñ–∏–∫ (–∫–æ–ø–∏—é) –≤ —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∏—Ö —Ç–æ—á–∫–∞—Ö —Å–µ—Ç–∏.

| –°–ø–æ—Å–æ–± | –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç | –°—Ç–æ–∏–º–æ—Å—Ç—å | –ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å |
|--------|-------------|-----------|------------|
| **SPAN/Mirror port** | –ö–æ–º–º—É—Ç–∞—Ç–æ—Ä –∫–æ–ø–∏—Ä—É–µ—Ç —Ç—Ä–∞—Ñ–∏–∫ –Ω–∞ –ø–æ—Ä—Ç | –ë–µ—Å–ø–ª–∞—Ç–Ω–æ | –°—Ä–µ–¥–Ω—è—è |
| **Network TAP** | –§–∏–∑–∏—á–µ—Å–∫–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –≤ —Ä–∞–∑—Ä—ã–≤ –∫–∞–±–µ–ª—è | 15-150–∫ —Ä—É–± | –í—ã—Å–æ–∫–∞—è |
| **Virtual TAP** | vSwitch mirroring (VMware/KVM/Hyper-V) | –ë–µ—Å–ø–ª–∞—Ç–Ω–æ | –í—ã—Å–æ–∫–∞—è |

### –ö—É–¥–∞ —Å—Ç–∞–≤–∏—Ç—å —Å–µ–Ω—Å–æ—Ä—ã

```
                        –ò–ù–¢–ï–†–ù–ï–¢
                            ‚îÇ
                     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                     ‚îÇ  Firewall   ‚îÇ
                     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                            ‚îÇ
                   ‚óâ –°–ï–ù–°–û–† #1        ‚Üê –ø–µ—Ä–∏–º–µ—Ç—Ä: C2, —ç–∫—Å—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è, DNS-—Ç—É–Ω–Ω–µ–ª–∏
                            ‚îÇ
                     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                     ‚îÇ Core Switch ‚îÇ
                     ‚îî‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îò
                        ‚îÇ    ‚îÇ  ‚îÇ
              ‚óâ –°–ï–ù–°–û–† #2    ‚îÇ  ‚îÇ  ‚Üê —è–¥—Ä–æ: lateral movement –º–µ–∂–¥—É VLAN'–∞–º–∏
                        ‚îÇ    ‚îÇ  ‚îÇ
          ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚ñº‚îÄ‚îÄ‚îê ‚îÇ ‚îå‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
          ‚îÇ   DMZ   ‚îÇ ‚îÇSrv ‚îÇ ‚îÇ ‚îÇ–ë—É—Ö–≥–∞–ª—Ç. ‚îÇ
          ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ1–°  ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
                    ‚óâ –°–ï–ù–°–û–† #3 (–æ–ø—Ü.)  ‚Üê —Å–µ—Ä–≤–µ—Ä–Ω—ã–π —Å–µ–≥–º–µ–Ω—Ç
                        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                        ‚îÇ  Wi-Fi  ‚îÇ
                        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ú–∏–Ω–∏–º—É–º (1 —Å–µ–Ω—Å–æ—Ä):** –ø–µ—Ä–∏–º–µ—Ç—Ä, 70-80% –ø–æ–∫—Ä—ã—Ç–∏—è.
**–û–ø—Ç–∏–º—É–º (2-3 —Å–µ–Ω—Å–æ—Ä–∞):** –ø–µ—Ä–∏–º–µ—Ç—Ä + core + —Å–µ—Ä–≤–µ—Ä–Ω—ã–π, 95% –ø–æ–∫—Ä—ã—Ç–∏—è.

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ–Ω—Å–æ—Ä–∞

```bash
$ curl -sSL https://ndr-lite.ru/install.sh | sudo bash

[1/5] System check...          ‚úì (4 cores, 8GB RAM)
[2/5] NATS server:             nats://ndr.company.ru:4222
[3/5] Sensor name:             perimeter-01
[4/5] Capture interface:       eth1
[5/5] Home networks:           10.0.0.0/8, 192.168.0.0/16

Starting...  ‚úì   Connected!  ‚úì
Traffic will appear within 5 minutes.
```

---

## üß© –°–µ—Ä–≤–µ—Ä–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã (Moleculer)

### Sensor Collector

```javascript
// sensor/services/collector.service.js
module.exports = {
    name: "collector",
    metadata: {
        sensorId: process.env.SENSOR_ID,
        interface: process.env.CAPTURE_IF,
        location: process.env.SENSOR_LOCATION
    },
    
    started() {
        this.suricata = this.startSuricata();
        this.zeek = this.startZeek();
        this.watchSuricataEve();
        this.watchZeekLogs();
    },

    methods: {
        async processConnection(conn) {
            const event = this.normalize(conn);
            this.broker.emit("event.connection", event);
            this.broker.emit("graph.connection", {
                srcIp: conn.src_ip, srcMac: conn.src_mac,
                dstIp: conn.dst_ip, dstMac: conn.dst_mac,
                dstPort: conn.dst_port, proto: conn.proto,
                bytesSent: conn.orig_bytes, bytesRecv: conn.resp_bytes,
                timestamp: conn.ts, sensorId: this.metadata.sensorId
            });
        },
        
        async processAlert(alert) {
            this.broker.emit("event.alert", this.normalizeAlert(alert),
                { groups: "alerts" });
        },
        
        async processDNS(dns) {
            this.broker.emit("event.dns", this.normalizeDNS(dns));
            this.broker.emit("graph.dns", {
                srcIp: dns.src_ip, query: dns.query, answer: dns.answer
            });
        }
    }
};
```

### Graph Builder

```javascript
// server/services/graph-builder.service.js
module.exports = {
    name: "graph-builder",
    
    events: {
        async "graph.connection"(ctx) {
            const { srcIp, srcMac, dstIp, dstMac, dstPort, proto,
                    bytesSent, bytesRecv, timestamp, sensorId } = ctx.params;
            const srcUid = await this.upsertHost(srcIp, srcMac, timestamp);
            const dstUid = await this.upsertHost(dstIp, dstMac, timestamp);
            await this.upsertConnection(srcUid, dstUid, {
                port: dstPort, protocol: proto,
                bytesSent, bytesRecv, timestamp, sensorId,
                isBaseline: this.isBaselinePhase
            });
        },
        
        async "graph.dns"(ctx) {
            const hostUid = await this.upsertHost(ctx.params.srcIp);
            const domainUid = await this.upsertDomain(ctx.params.query);
            await this.createEdge(hostUid, "host.resolves", domainUid);
        }
    },
    
    methods: {
        async upsertHost(ip, mac, lastSeen) {
            const query = `{ host as var(func: eq(host.ip, "${ip}")) }`;
            const mutation = {
                uid: "uid(host)",
                "host.ip": ip, "host.mac": mac || "",
                "host.last_seen": lastSeen,
                "host.subnet": this.getSubnet(ip),
                "dgraph.type": "Host"
            };
            return await this.dgraph.upsert(query, mutation);
        },
        
        async snapshotBaseline() {
            this.isBaselinePhase = false;
            this.broker.broadcast("baseline.completed");
        }
    },
    
    created() {
        this.isBaselinePhase = true;
        setTimeout(() => this.snapshotBaseline(), 24 * 60 * 60 * 1000);
    }
};
```

### Correlation Engine

```javascript
// server/services/correlation.service.js
module.exports = {
    name: "correlation",
    dependencies: ["graph-builder", "ingestion"],
    
    events: {
        async "correlate.alert"(ctx) {
            for (const rule of this.eventRules) {
                const result = await rule.evaluate(ctx.params, this.broker);
                if (result) await this.createOrUpdateIncident(result);
            }
        },
        "baseline.completed"() { this.startGraphCorrelation(); }
    },
    
    methods: {
        startGraphCorrelation() {
            setInterval(async () => {
                for (const rule of this.graphRules) {
                    const incidents = await rule.evaluate(this.broker);
                    for (const inc of incidents)
                        await this.createOrUpdateIncident(inc);
                }
            }, 60_000);
        }
    },
    
    started() {
        // Event-based (—Ä–µ–∞–∫—Ç–∏–≤–Ω—ã–µ, 13 –ø—Ä–∞–≤–∏–ª)
        this.eventRules = [
            new PortScanRule(),          // >20 –ø–æ—Ä—Ç–æ–≤ –∑–∞ 60—Å
            new BruteForceRule(),        // SSH/RDP brute-force
            new DNSTunnelRule(),         // –∞–Ω–æ–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞/—á–∞—Å—Ç–æ—Ç–∞ DNS
            new C2DetectionRule(),       // C2 –∏–∑ threat feeds
            new DataExfilRule(),         // –∞–Ω–æ–º–∞–ª—å–Ω—ã–π –æ–±—ä—ë–º –Ω–∞—Ä—É–∂—É
            new SuspiciousUARule(),      // –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–π user-agent
            new LLMNRPoisonRule(),       // LLMNR/NBT-NS poisoning
            new FreshDomainTLSRule(),    // TLS –∫ –¥–æ–º–µ–Ω—É <7 –¥–Ω–µ–π
            new NewDeviceRule(),         // –Ω–æ–≤–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
            new AnomalyVolumeRule(),     // Isolation Forest (Python ML)
            new JA3MaliciousRule(),      // JA3 = Cobalt Strike/Metasploit
            new JA3NewClientRule(),      // JA3 –Ω–µ –∏–∑ baseline
            new ADOffHoursAdminRule(),   // Domain Admin –≤–Ω–µ —Ä–∞–±–æ—á–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
        ];
        // Graph-based (–ø–æ—Å–ª–µ baseline, 5 –ø—Ä–∞–≤–∏–ª)
        this.graphRules = [
            new LateralMovementRule(),   // —Ü–µ–ø–æ—á–∫–∞ ‚â•2 —Ö–æ–ø–∞ –Ω–æ–≤—ã—Ö —Å–≤—è–∑–µ–π
            new NewConnectionRule(),     // —Å–≤—è–∑–∏ –≤–Ω–µ baseline
            new CrossSegmentRule(),      // DMZ‚ÜíInternal –Ω–∞–ø—Ä—è–º—É—é
            new CommunityAnomalyRule(),  // —Ö–æ—Å—Ç —Å–º–µ–Ω–∏–ª –≥—Ä—É–ø–ø—É
            new CriticalExposureRule(),  // –ø—É—Ç—å –∏–∑ external –¥–æ critical
        ];
        // AD-based (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –µ—Å–ª–∏ AD –ø–æ–¥–∫–ª—é—á—ë–Ω, 2 –ø—Ä–∞–≤–∏–ª–∞)
        this.adRules = [
            new MultiHostLoginRule(),    // –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞ ‚â•3 —Ö–æ—Å—Ç–∞—Ö
            new PrivilegeEscalationRule(), // –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –ø—Ä–∏–≤–∏–ª. –≥—Ä—É–ø–ø—É
        ];
    }
};
```

### Graph Analytics

```javascript
// server/services/graph-analytics.service.js
module.exports = {
    name: "graph-analytics",

    actions: {
        async blastRadius(ctx) {
            const query = `{
                blast(func: eq(host.ip, "${ctx.params.ip}")) @recurse(depth: 4) {
                    uid host.ip host.hostname host.is_critical
                    host.risk_score host.services
                    host.connects_to @filter(gt(host.last_seen, "${this.weekAgo()}"))
                }
            }`;
            const result = await this.dgraph.query(query);
            const hosts = this.extractHosts(result);
            return {
                compromised: ctx.params.ip,
                reachableHosts: hosts.length,
                criticalAtRisk: hosts.filter(h => h.is_critical),
                maxDepth: this.calculateMaxDepth(result),
                graphData: result
            };
        },
        
        async attackPath(ctx) {
            const query = `{
                path as shortest(from: uid(src), to: uid(dst)) {
                    host.connects_to
                }
                src(func: eq(host.ip, "${ctx.params.from}")) { uid }
                dst(func: eq(host.ip, "${ctx.params.to}")) { uid }
            }`;
            return await this.dgraph.query(query);
        },
        
        async topology(ctx) {
            const filter = ctx.params.subnet
                ? `@filter(eq(host.subnet, "${ctx.params.subnet}"))` : "";
            const query = `{
                hosts(func: has(host.ip)) ${filter} {
                    uid host.ip host.hostname host.subnet
                    host.risk_score host.is_critical
                    host.services host.os host.role
                    host.connects_to { uid host.ip host.subnet }
                }
            }`;
            return await this.dgraph.query(query);
        },
        
        async riskScore(ctx) {
            const { ip } = ctx.params;
            let score = 0;
            const alerts = await this.getHostAlerts(ip);
            score += Math.min(40, alerts.reduce((s, a) =>
                s + SEVERITY_WEIGHTS[a.severity], 0));
            const degree = await this.getDegreeCentrality(ip);
            score += Math.min(20, degree * 2);
            const hops = await this.shortestPathToCritical(ip);
            score += hops <= 1 ? 20 : hops <= 2 ? 15 : hops <= 3 ? 10 : 0;
            const newConn = await this.countNonBaselineEdges(ip);
            score += Math.min(20, newConn * 5);
            return { ip, riskScore: Math.min(100, score) };
        }
    }
};
```

### LLM Service (Python / Pylecular)

```python
# python/services/llm_service.py
from pylecular.service import Service
from pylecular.decorators import action, event
from llm.providers import get_llm_client
from llm.prompts import SYSTEM_PROMPT
from llm.context_builder import build_incident_prompt
import os

class LlmService(Service):
    name = "llm"
    dependencies = ["graph-analytics"]

    def created(self):
        provider = os.getenv("LLM_PROVIDER", "ollama")
        self.client = get_llm_client(provider)

    @action()
    async def explain_incident(self, ctx):
        incident_id = ctx.params["incidentId"]

        # –í—ã–∑—ã–≤–∞–µ–º Node.js —Å–µ—Ä–≤–∏—Å—ã —á–µ—Ä–µ–∑ NATS (–ø—Ä–æ–∑—Ä–∞—á–Ω–æ)
        attack_path, blast_radius = await asyncio.gather(
            ctx.call("graph-analytics.attackPath", {
                "from": ctx.params["entryPoint"],
                "to": ctx.params["target"]
            }),
            ctx.call("graph-analytics.blastRadius", {
                "ip": ctx.params["compromisedHost"]
            })
        )

        prompt = build_incident_prompt(
            incident=ctx.params["incident"],
            attack_path=attack_path,
            blast_radius=blast_radius,
            events=ctx.params.get("events", [])
        )

        response = await self.client.chat(
            system=SYSTEM_PROMPT,
            messages=[{"role": "user", "content": prompt}]
        )
        return {"explanation": response, "provider": self.client.provider_name}

    @action()
    async def chat(self, ctx):
        """–°–≤–æ–±–æ–¥–Ω—ã–π —á–∞—Ç —Å AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–æ–º (—Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º –≥—Ä–∞—Ñ–∞)"""
        messages = ctx.params.get("messages", [])
        graph_context = ctx.params.get("graphContext", "")

        system = SYSTEM_PROMPT
        if graph_context:
            system += f"\n\n–¢–µ–∫—É—â–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç —Å–µ—Ç–∏:\n{graph_context}"

        return await self.client.chat(system=system, messages=messages)

    @event("incident.created")
    async def on_incident_created(self, ctx):
        """–ê–≤—Ç–æ-–æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞ (–µ—Å–ª–∏ AI –≤–∫–ª—é—á—ë–Ω)"""
        if not self.client:
            return
        self.logger.info(f"Auto-explaining incident {ctx.params['id']}")
        explanation = await self.actions["explain_incident"](ctx)
        await ctx.emit("incident.explained", {
            "incidentId": ctx.params["id"],
            "explanation": explanation
        })
```

```python
# python/llm/providers.py
import httpx, os

class OllamaClient:
    provider_name = "ollama"
    def __init__(self):
        self.url = os.getenv("OLLAMA_URL", "http://localhost:11434")
        self.model = os.getenv("OLLAMA_MODEL", "llama3.1:8b")

    async def chat(self, system: str, messages: list) -> str:
        async with httpx.AsyncClient(timeout=120) as client:
            resp = await client.post(f"{self.url}/api/chat", json={
                "model": self.model,
                "messages": [{"role": "system", "content": system}] + messages,
                "stream": False
            })
            return resp.json()["message"]["content"]

class ClaudeClient:
    provider_name = "claude"
    def __init__(self):
        self.api_key = os.getenv("ANTHROPIC_API_KEY")
        self.model = "claude-sonnet-4-20250514"

    async def chat(self, system: str, messages: list) -> str:
        async with httpx.AsyncClient(timeout=120) as client:
            resp = await client.post(
                "https://api.anthropic.com/v1/messages",
                headers={
                    "x-api-key": self.api_key,
                    "anthropic-version": "2023-06-01",
                    "content-type": "application/json"
                },
                json={
                    "model": self.model,
                    "max_tokens": 4096,
                    "system": system,
                    "messages": messages
                }
            )
            return resp.json()["content"][0]["text"]

class YandexGPTClient:
    provider_name = "yandexgpt"
    # ... –∞–Ω–∞–ª–æ–≥–∏—á–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è YandexGPT API

class GigaChatClient:
    provider_name = "gigachat"
    # ... –∞–Ω–∞–ª–æ–≥–∏—á–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è GigaChat API

def get_llm_client(provider: str):
    clients = {
        "ollama": OllamaClient,
        "claude": ClaudeClient,
        "yandexgpt": YandexGPTClient,
        "gigachat": GigaChatClient,
        "none": lambda: None
    }
    return clients.get(provider, clients["none"])()
```

### ML Service (Python / Pylecular)

```python
# python/services/ml_service.py
from pylecular.service import Service
from pylecular.decorators import action, event
from ml.anomaly_detector import AnomalyDetector
from ml.baseline_builder import BaselineBuilder

class MlService(Service):
    name = "ml"

    def created(self):
        self.detector = AnomalyDetector()
        self.baseline = BaselineBuilder()

    @action()
    async def anomaly_detect(self, ctx):
        """Isolation Forest: –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∞–Ω–æ–º–∞–ª—å–Ω—ã—Ö –æ–±—ä—ë–º–æ–≤ —Ç—Ä–∞—Ñ–∏–∫–∞"""
        features = ctx.params["features"]  # bytes, packets, duration, connections
        scores = self.detector.predict(features)
        return {
            "scores": scores,
            "anomalies": [s for s in scores if s["is_anomaly"]],
            "model_version": self.detector.version
        }

    @action()
    async def update_baseline(self, ctx):
        """–û–±–Ω–æ–≤–∏—Ç—å baseline –¥–ª—è —Ö–æ—Å—Ç–∞ –ø–æ –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–º –¥–∞–Ω–Ω—ã–º"""
        host_ip = ctx.params["ip"]
        history = ctx.params["history"]  # 7 –¥–Ω–µ–π –º–µ—Ç—Ä–∏–∫
        self.baseline.fit(host_ip, history)
        return {"status": "updated", "host": host_ip}

    @action()
    async def check_deviation(self, ctx):
        """–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –æ—Ç baseline (œÉ)"""
        host_ip = ctx.params["ip"]
        current = ctx.params["metrics"]
        deviation = self.baseline.deviation(host_ip, current)
        return {
            "host": host_ip,
            "deviation_sigma": deviation,
            "is_anomaly": abs(deviation) > 3.0
        }

    @event("flow.aggregated")
    async def on_flow(self, ctx):
        """–†–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ—Ç–æ–∫–∏ ‚Äî –∞–≤—Ç–æ–ø—Ä–æ–≤–µ—Ä–∫–∞"""
        result = await self.actions["check_deviation"]({
            "ip": ctx.params["src_ip"],
            "metrics": ctx.params["metrics"]
        })
        if result["is_anomaly"]:
            await ctx.emit("ml.anomaly_detected", {
                "host": ctx.params["src_ip"],
                "deviation": result["deviation_sigma"],
                "metrics": ctx.params["metrics"]
            })
```

```python
# python/pylecular_config.py ‚Äî —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ Python-–Ω–æ–¥—ã
import asyncio
from pylecular.broker import ServiceBroker
from services.ml_service import MlService
from services.llm_service import LlmService
from services.notification_service import NotificationService
from services.ad_sync_service import ADSyncService
from services.threat_intel_service import ThreatIntelService

broker = ServiceBroker(
    node_id="ndr-python-1",
    transporter="nats://nats:4222",
    serializer="JSON",
    log_level="info"
)

broker.create_service(MlService)
broker.create_service(LlmService)
broker.create_service(NotificationService)
broker.create_service(ADSyncService)
broker.create_service(ThreatIntelService)

if __name__ == "__main__":
    asyncio.run(broker.start())
```

### API Gateway

```javascript
// server/services/api.service.js
module.exports = {
    name: "api",
    mixins: [require("moleculer-web")],
    settings: {
        port: 3000,
        routes: [{
            path: "/api",
            authorization: true,
            aliases: {
                "GET /dashboard/stats":         "dashboard.stats",
                "GET /dashboard/timeline":      "dashboard.timeline",
                "GET /incidents":               "incidents.list",
                "GET /incidents/:id":           "incidents.get",
                "PUT /incidents/:id":           "incidents.update",
                "GET /graph/topology":          "graph-analytics.topology",
                "GET /graph/blast-radius/:ip":  "graph-analytics.blastRadius",
                "GET /graph/attack-path":       "graph-analytics.attackPath",
                "GET /graph/risk-score/:ip":    "graph-analytics.riskScore",
                "GET /assets":                  "assets.list",
                "GET /assets/:ip":              "assets.profile",
                "POST /ai/explain":             "llm.explainIncident",
                "POST /ai/chat":                "llm.chat",
                "POST /reports/generate":       "reports.generate",
                "GET /sensors":                 "sensors.list",
                "GET /sensors/:id/status":      "sensors.status",
                // Simulation & Segmentation
                "POST /simulation/compromise":  "graph-analytics.simulateCompromise",
                "POST /simulation/mitigation":  "graph-analytics.simulateMitigation",
                "GET /segmentation/score":      "graph-analytics.segmentationScore",
                // Compliance reports
                "POST /compliance/inventory":   "compliance-reports.generateInventoryAct",
                "POST /compliance/flows":       "compliance-reports.generateSegmentationReport",
                "POST /compliance/journal":     "compliance-reports.generateIncidentJournal",
                "POST /compliance/asset-card":  "compliance-reports.generateAssetCard",
                // AD integration
                "POST /ad/sync":                "ad-sync.sync",
                "GET /ad/status":               "ad-sync.status",
                // Threat Intelligence
                "GET /threat-intel/stats":      "threat-intel.get_stats",
                "POST /threat-intel/check/ip":  "threat-intel.check_ip",
                "POST /threat-intel/check/domain": "threat-intel.check_domain",
                "POST /threat-intel/check/ja3": "threat-intel.check_ja3",
                "POST /threat-intel/update":    "threat-intel.update_all",
            }
        }]
    }
};
```

---

## üóÑ Dgraph Schema

```graphql
# –ü—Ä–µ–¥–∏–∫–∞—Ç—ã
host.ip: string @index(exact, term) .
host.hostname: string @index(term, fulltext) .
host.mac: string @index(exact) .
host.subnet: string @index(exact) .
host.os: string @index(term) .
host.services: [string] @index(term) .
host.role: string @index(exact) .
host.first_seen: datetime .
host.last_seen: datetime .
host.risk_score: float .
host.is_critical: bool @index(bool) .
host.connects_to: [uid] @reverse @count .
host.resolves: [uid] @count .
host.has_alert: [uid] @reverse @count .
host.belongs_to: uid .

# AD integration
host.ad_username: string @index(exact, term) .
host.ad_department: string @index(exact) .
host.ad_groups: [string] @index(term) .
host.ad_last_logon: datetime .
host.ad_is_admin: bool @index(bool) .

ad.username: string @index(exact, term) .
ad.display_name: string @index(fulltext) .
ad.department: string @index(exact) .
ad.groups: [string] @index(term) .
ad.last_logon: datetime .
ad.is_admin: bool @index(bool) .
ad.logged_on_hosts: [uid] @reverse .

domain.name: string @index(exact, fulltext) .
domain.first_resolved: datetime .
domain.registration_age_days: int .
domain.is_malicious: bool @index(bool) .
domain.resolved_to: [uid] .
domain.queried_by: [uid] @reverse .

subnet.cidr: string @index(exact) .
subnet.name: string @index(term) .
subnet.zone: string @index(exact) .
subnet.hosts: [uid] @reverse @count .

alert.signature: string @index(fulltext) .
alert.severity: string @index(exact) .
alert.mitre_tactic: string @index(exact) .
alert.mitre_technique: string @index(exact) .
alert.timestamp: datetime @index(hour) .
alert.source: uid .
alert.destination: uid .
alert.raw_event_id: string .

incident.title: string @index(fulltext) .
incident.severity: string @index(exact) .
incident.status: string @index(exact) .
incident.created_at: datetime @index(hour) .
incident.involves_hosts: [uid] @count .
incident.involves_alerts: [uid] @count .
incident.attack_path: [uid] .
incident.mitre_tactics: [string] .
incident.llm_summary: string .

# –¢–∏–ø—ã
type Host {
    host.ip host.hostname host.mac host.subnet host.os
    host.services host.role host.first_seen host.last_seen
    host.risk_score host.is_critical
    host.connects_to host.resolves host.has_alert host.belongs_to
}
type Domain {
    domain.name domain.first_resolved domain.registration_age_days
    domain.is_malicious domain.resolved_to domain.queried_by
}
type Subnet {
    subnet.cidr subnet.name subnet.zone subnet.hosts
}
type Alert {
    alert.signature alert.severity alert.mitre_tactic
    alert.mitre_technique alert.timestamp
    alert.source alert.destination alert.raw_event_id
}
type Incident {
    incident.title incident.severity incident.status
    incident.created_at incident.involves_hosts
    incident.involves_alerts incident.attack_path
    incident.mitre_tactics incident.llm_summary
}
type ADUser {
    ad.username ad.display_name ad.department
    ad.groups ad.last_logon ad.is_admin
    ad.logged_on_hosts
}
```

---

## üóÉ ClickHouse Schema (—Å–æ–±—ã—Ç–∏—è –∏ –∞–ª–µ—Ä—Ç—ã)

ClickHouse –∑–∞–º–µ–Ω—è–µ—Ç Elasticsearch. SQL-–∑–∞–ø—Ä–æ—Å—ã, —Å–∂–∞—Ç–∏–µ 5-10x, –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ RAM 1-2GB –≤–º–µ—Å—Ç–æ 4-8GB.

```sql
-- –û—Å–Ω–æ–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Å–æ–±—ã—Ç–∏–π (–ø–∞—Ä—Ç–∏—Ü–∏–∏ –ø–æ –¥–Ω—è–º, TTL 90 –¥–Ω–µ–π)
CREATE TABLE events (
    timestamp       DateTime64(3),
    event_type      LowCardinality(String),  -- 'alert', 'flow', 'dns', 'http', 'tls'
    src_ip          String,
    dst_ip          String,
    src_port        UInt16,
    dst_port        UInt16,
    proto           LowCardinality(String),  -- 'TCP', 'UDP', 'ICMP'
    
    -- Suricata alert fields
    alert_signature String     DEFAULT '',
    alert_severity  UInt8      DEFAULT 0,
    alert_category  LowCardinality(String) DEFAULT '',
    mitre_tactic    LowCardinality(String) DEFAULT '',
    mitre_technique LowCardinality(String) DEFAULT '',
    
    -- Flow / traffic fields
    bytes_toserver  UInt64 DEFAULT 0,
    bytes_toclient  UInt64 DEFAULT 0,
    packets         UInt32 DEFAULT 0,
    duration        Float32 DEFAULT 0,
    
    -- DNS fields
    dns_query       String DEFAULT '',
    dns_type        LowCardinality(String) DEFAULT '',
    dns_answer      String DEFAULT '',
    
    -- TLS / JA3 fields
    ja3_hash        String DEFAULT '',
    ja3s_hash       String DEFAULT '',
    ja4_hash        String DEFAULT '',
    tls_sni         String DEFAULT '',
    tls_version     LowCardinality(String) DEFAULT '',
    
    -- Metadata
    sensor_id       String,
    incident_id     String DEFAULT '',
    
    -- –ò–Ω–¥–µ–∫—Å—ã
    INDEX idx_src_ip src_ip TYPE bloom_filter GRANULARITY 4,
    INDEX idx_dst_ip dst_ip TYPE bloom_filter GRANULARITY 4,
    INDEX idx_alert  alert_signature TYPE tokenbf_v1(512, 3, 0) GRANULARITY 4,
    INDEX idx_ja3    ja3_hash TYPE bloom_filter GRANULARITY 4
)
ENGINE = MergeTree()
PARTITION BY toYYYYMMDD(timestamp)
ORDER BY (event_type, src_ip, dst_ip, timestamp)
TTL timestamp + INTERVAL 90 DAY
SETTINGS index_granularity = 8192;

-- –ú–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –∞–≥—Ä–µ–≥–∞—Ü–∏–π

-- Top talkers –ø–æ —á–∞—Å–∞–º (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è)
CREATE MATERIALIZED VIEW host_traffic_hourly
ENGINE = SummingMergeTree()
PARTITION BY toYYYYMM(hour)
ORDER BY (hour, src_ip)
AS SELECT
    toStartOfHour(timestamp) AS hour,
    src_ip,
    count()                  AS event_count,
    sum(bytes_toserver + bytes_toclient) AS total_bytes,
    uniqExact(dst_ip)        AS unique_destinations,
    uniqExact(dst_port)      AS unique_ports
FROM events
GROUP BY hour, src_ip;

-- –°—á—ë—Ç—á–∏–∫–∏ –∞–ª–µ—Ä—Ç–æ–≤ –ø–æ —Ç–∏–ø–∞–º (–¥–ª—è dashboard)
CREATE MATERIALIZED VIEW alert_stats_daily
ENGINE = SummingMergeTree()
PARTITION BY toYYYYMM(day)
ORDER BY (day, alert_severity, mitre_tactic)
AS SELECT
    toDate(timestamp)        AS day,
    alert_severity,
    mitre_tactic,
    alert_category,
    count()                  AS alert_count,
    uniqExact(src_ip)        AS unique_sources
FROM events
WHERE event_type = 'alert'
GROUP BY day, alert_severity, mitre_tactic, alert_category;
```

**–¢–∏–ø–∏—á–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∏–∑ —Å–µ—Ä–≤–∏—Å–æ–≤:**

```sql
-- Dashboard: –∞–ª–µ—Ä—Ç—ã –∑–∞ —Å–µ–≥–æ–¥–Ω—è –ø–æ severity
SELECT alert_severity, count() as cnt
FROM events
WHERE event_type = 'alert' AND timestamp > today()
GROUP BY alert_severity;

-- Incident timeline: –≤—Å–µ —Å–æ–±—ã—Ç–∏—è –º–µ–∂–¥—É –¥–≤—É–º—è —Ö–æ—Å—Ç–∞–º–∏
SELECT timestamp, event_type, dst_port, alert_signature,
       bytes_toserver + bytes_toclient as bytes
FROM events
WHERE src_ip = '10.0.1.45' AND dst_ip = '10.0.1.1'
  AND timestamp BETWEEN '2025-01-15 08:00:00' AND '2025-01-15 12:00:00'
ORDER BY timestamp;

-- ML: –º–µ—Ç—Ä–∏–∫–∏ —Ö–æ—Å—Ç–∞ –∑–∞ —á–∞—Å (–¥–ª—è Isolation Forest baseline)
SELECT toStartOfHour(timestamp) as hour,
       sum(bytes_toserver + bytes_toclient) as total_bytes,
       count() as connections,
       uniqExact(dst_ip) as unique_dsts,
       uniqExact(dst_port) as unique_ports
FROM events
WHERE src_ip = {host_ip:String}
  AND timestamp > now() - INTERVAL 7 DAY
GROUP BY hour
ORDER BY hour;

-- –ü–æ–∏—Å–∫ DNS-—Ç—É–Ω–Ω–µ–ª–µ–π: –¥–æ–º–µ–Ω—ã —Å –¥–ª–∏–Ω–Ω—ã–º–∏ –∏–º–µ–Ω–∞–º–∏
SELECT dns_query, count() as queries, uniqExact(src_ip) as hosts
FROM events
WHERE event_type = 'dns'
  AND length(dns_query) > 50
  AND timestamp > now() - INTERVAL 1 DAY
GROUP BY dns_query
ORDER BY queries DESC
LIMIT 20;
```

**Docker Compose:**

```yaml
  clickhouse:
    image: clickhouse/clickhouse-server:24-alpine
    ports:
      - "8123:8123"   # HTTP interface
      - "9000:9000"   # Native interface
    volumes:
      - clickhouse-data:/var/lib/clickhouse
      - ./deploy/clickhouse/init.sql:/docker-entrypoint-initdb.d/init.sql
    environment:
      CLICKHOUSE_DB: ndr
      CLICKHOUSE_USER: ndr
      CLICKHOUSE_PASSWORD: ${CH_PASSWORD:-ndr_secret}
    deploy:
      resources:
        limits:
          memory: 2G   # vs 8G –¥–ª—è Elasticsearch
    ulimits:
      nofile:
        soft: 262144
        hard: 262144
```

---

## üñ• Web UI

### Dashboard
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  NDR-lite          [Sensors: 2 online]   [User] [‚öô]     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ üî¥ 3      ‚îÇ üü° 7      ‚îÇ üü¢ 124    ‚îÇ üìä 2.4 Gbps         ‚îÇ
‚îÇ Critical  ‚îÇ Warning   ‚îÇ Info      ‚îÇ Traffic now          ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  [‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê Timeline –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤ –∑–∞ 24 —á–∞—Å–∞ ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê]        ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê‚îÇ
‚îÇ  ‚îÇ  LIVE NETWORK GRAPH       ‚îÇ  ‚îÇ  Risk Scorecard        ‚îÇ‚îÇ
‚îÇ  ‚îÇ    [DC] ‚Üê‚îÄ‚îÄ [WS1]        ‚îÇ  ‚îÇ  10.0.0.1 (DC)    92  ‚îÇ‚îÇ
‚îÇ  ‚îÇ     ‚Üë        ‚Üï            ‚îÇ  ‚îÇ  10.0.0.45        87  ‚îÇ‚îÇ
‚îÇ  ‚îÇ   [DB] ‚Üê‚îÄ‚îÄ [WS2]‚îÄ‚îÄ‚Üí[EXT]‚îÇ  ‚îÇ  192.168.1.5      71  ‚îÇ‚îÇ
‚îÇ  ‚îÇ   [APP]‚Üê‚îÄ‚îÄ [WS3]         ‚îÇ  ‚îÇ  [‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñë‚ñë] 72 avg ‚îÇ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê‚îÇ
‚îÇ  ‚îÇ  –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã                                  ‚îÇ‚îÇ
‚îÇ  ‚îÇ  üî¥ Lateral Movement: WS2‚ÜíWS5‚ÜíDC (3 —Ö–æ–ø–∞ –∑–∞ 12–º–∏–Ω) ‚îÇ‚îÇ
‚îÇ  ‚îÇ  üî¥ Attack path found: EXT‚ÜíDMZ‚ÜíAPP‚ÜíDB               ‚îÇ‚îÇ
‚îÇ  ‚îÇ  üü° New cross-segment: –ë—É—Ö–≥–∞–ª—Ç–µ—Ä–∏—è ‚Üí –°–µ—Ä–≤–µ—Ä–Ω–∞—è       ‚îÇ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Network Graph (–∫–ª—é—á–µ–≤–æ–π —ç–∫—Ä–∞–Ω)
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Network Graph    [Subnet ‚ñº] [Time ‚ñº] [Risk ‚ñº] [Layout] ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ   ‚îå‚îÄDMZ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄInternal‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ   ‚îÇ  [WebSrv]‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚Üí‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ[AppSrv]‚îÄ‚îÄ‚Üí‚îÄ‚îÄ[DB-01]    ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ  [MailSrv]    ‚îÇ     ‚îÇ      ‚Üë          (risk:92)  ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ               ‚îÇ     ‚îÇ   [WS-12]‚îÄ‚îÄ‚Üí‚îÄ‚îÄ[DC-01]      ‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îÇ   (risk:87)   (risk:95)    ‚îÇ   ‚îÇ
‚îÇ   ‚îå‚îÄWi-Fi‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îÇ   [WS-01] [WS-02] [WS-03] ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ [Laptop1]‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚Üí‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ[Printer]                ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ [IoT-cam]     ‚îÇ     ‚îÇ                             ‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ  ‚îÄ‚îÄ baseline    ‚ïå‚ïå new connection    thickness = volume   ‚îÇ
‚îÇ  üî¥ risk>80    üü° risk>50    üü¢ risk<50    ‚óÜ critical    ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  Selected: WS-12 ‚îÇ Risk: 87 ‚îÇ Baseline: 12 ‚îÇ New: 3 (!) ‚îÇ
‚îÇ  [View blast radius]  [Show path to critical]  [Details] ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Incident Card
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  üî¥ INC-2025-0042: Lateral Movement Chain                ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  ATTACK PATH:                                            ‚îÇ
‚îÇ  [EXT:45.33.x.x] ‚îÄ‚îÄ‚Üí [WS-12] ‚îÄ‚îÄ‚Üí [WS-05] ‚îÄ‚îÄ‚Üí [DC]     ‚îÇ
‚îÇ     14:23 RDP          14:35 SMB     14:41 LDAP          ‚îÇ
‚îÇ                                                           ‚îÇ
‚îÇ  MITRE ATT&CK:                                           ‚îÇ
‚îÇ  [Initial Access] ‚Üí [Execution] ‚Üí [Lateral Movement]     ‚îÇ
‚îÇ  BLAST RADIUS: DC ‚Üí 47 —Ö–æ—Å—Ç–æ–≤ –ø–æ–¥ —É–≥—Ä–æ–∑–æ–π                ‚îÇ
‚îÇ                                                           ‚îÇ
‚îÇ  ü§ñ AI: –ê—Ç–∞–∫—É—é—â–∏–π –ø–æ–¥–æ–±—Ä–∞–ª –ø–∞—Ä–æ–ª—å –∫ WS-12 —á–µ—Ä–µ–∑ RDP.    ‚îÇ
‚îÇ  –ß–µ—Ä–µ–∑ SMB –ø–µ—Ä–µ—à—ë–ª –Ω–∞ WS-05, –∏–∑–≤–ª—ë–∫ —É—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ,     ‚îÇ
‚îÇ  –Ω–∞—á–∞–ª —Ä–∞–∑–≤–µ–¥–∫—É AD —á–µ—Ä–µ–∑ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –¥–æ–º–µ–Ω–∞.              ‚îÇ
‚îÇ  –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏: 1) –ò–∑–æ–ª–∏—Ä–æ–≤–∞—Ç—å WS-12/WS-05               ‚îÇ
‚îÇ  2) –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å 45.33.x.x  3) –°–±—Ä–æ—Å–∏—Ç—å –ø–∞—Ä–æ–ª–∏         ‚îÇ
‚îÇ                                                           ‚îÇ
‚îÇ  [Export PDF]  [Copy IoCs]  [Mark Resolved]               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### AI Assistant
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  ü§ñ AI –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç                                ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  User: –ü–æ–∫–∞–∂–∏ blast radius –¥–ª—è DC-01             ‚îÇ
‚îÇ                                                  ‚îÇ
‚îÇ  AI: –ï—Å–ª–∏ DC-01 —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω:               ‚îÇ
‚îÇ  1 —Ö–æ–ø: 23 —Ö–æ—Å—Ç–∞ (–≤–∫–ª. DB-01, MailSrv)          ‚îÇ
‚îÇ  2 —Ö–æ–ø–∞: +31 —Ö–æ—Å—Ç (–≤—Å—è –±—É—Ö–≥–∞–ª—Ç–µ—Ä–∏—è)             ‚îÇ
‚îÇ  3 —Ö–æ–ø–∞: –≤—ã—Ö–æ–¥ –≤ DMZ —á–µ—Ä–µ–∑ AppSrv               ‚îÇ
‚îÇ  –ò—Ç–æ–≥–æ: 54 –∏–∑ 67 (81%) –ø–æ–¥ —É–≥—Ä–æ–∑–æ–π              ‚îÇ
‚îÇ                                                  ‚îÇ
‚îÇ  User: –ö–∞–∫ —É–º–µ–Ω—å—à–∏—Ç—å?                            ‚îÇ
‚îÇ                                                  ‚îÇ
‚îÇ  AI: 3 —É–∑–∫–∏—Ö –º–µ—Å—Ç–∞ –≤ –≥—Ä–∞—Ñ–µ:                     ‚îÇ
‚îÇ  1. AppSrv ‚Äî –º–æ—Å—Ç Internal‚ÜîDMZ, –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å 443  ‚îÇ
‚îÇ  2. WS-12 ‚Äî RDP –Ω–∞ 8 —Ö–æ—Å—Ç–æ–≤, –∏–∑–±—ã—Ç–æ—á–Ω–æ          ‚îÇ
‚îÇ  3. DB-01 ‚Äî –¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑ 5 –ø–æ–¥—Å–µ—Ç–µ–π ‚Üí only AppSrv‚îÇ
‚îÇ                                                  ‚îÇ
‚îÇ  [____________________________] [Send]           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```
```

---

## üß© –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏

### NDR-lite Discovery ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç (–±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –ø—Ä–æ–¥–∞–∂)

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–∞—Ä—Ç–∞ —Å–µ—Ç–∏ ‚Äî —ç—Ç–æ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å –µ—â—ë –î–û –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∞—Ç–∞–∫. –í—ã–¥–µ–ª—è–µ–º –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π –¥–µ—à—ë–≤—ã–π –ø—Ä–æ–¥—É–∫—Ç –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –≤—ã—Ö–æ–¥–∞ –Ω–∞ —Ä—ã–Ω–æ–∫.

**–ß—Ç–æ —ç—Ç–æ:** –ü–æ–¥–∫–ª—é—á–∏–ª —Å–µ–Ω—Å–æ—Ä ‚Üí —á–µ—Ä–µ–∑ 24 —á–∞—Å–∞ –ø–æ–ª—É—á–∏–ª –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é –∫–∞—Ä—Ç—É –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤, —Å–≤—è–∑–µ–π, —Å–µ—Ä–≤–∏—Å–æ–≤, –ø–æ–¥—Å–µ—Ç–µ–π. –ë–µ–∑ —Ä—É—á–Ω–æ–≥–æ –≤–≤–æ–¥–∞.

**–î–ª—è –∫–æ–≥–æ:** IT-–¥–∏—Ä–µ–∫—Ç–æ—Ä–∞, –∞—É–¥–∏—Ç–æ—Ä—ã, compliance-–æ—Ç–¥–µ–ª—ã, MSP. –í—Å–µ, –∫–æ–º—É –Ω—É–∂–µ–Ω –æ—Ç–≤–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å ¬´—á—Ç–æ —É –Ω–∞—Å –≤ —Å–µ—Ç–∏?¬ª.

**–ß—Ç–æ –≤—Ö–æ–¥–∏—Ç:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Ö–æ—Å—Ç–æ–≤ (IP, MAC, hostname, OS fingerprint)
- –í–∏–∑—É–∞–ª—å–Ω—ã–π –≥—Ä–∞—Ñ —Å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π –ø–æ –ø–æ–¥—Å–µ—Ç—è–º (Cytoscape.js)
- –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤ –Ω–∞ –∫–∞–∂–¥–æ–º —Ö–æ—Å—Ç–µ (–ø–æ—Ä—Ç—ã, –ø—Ä–æ—Ç–æ–∫–æ–ª—ã)
- –ú–∞—Ç—Ä–∏—Ü–∞ —Å–≤—è–∑–µ–π: –∫—Ç–æ —Å –∫–µ–º –æ–±—â–∞–µ—Ç—Å—è, –æ–±—ä—ë–º, —á–∞—Å—Ç–æ—Ç–∞
- PDF-–æ—Ç—á—ë—Ç: ¬´–ê–∫—Ç –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏–∏ —Å–µ—Ç–µ–≤—ã—Ö –∞–∫—Ç–∏–≤–æ–≤¬ª
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏: –Ω–æ–≤–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ ‚Üí –∞–ª–µ—Ä—Ç ‚Üí –Ω–∞ –∫–∞—Ä—Ç–µ

**–ß–µ–≥–æ –Ω–µ—Ç (–æ—Ç–ª–∏—á–∏–µ –æ—Ç –ø–æ–ª–Ω–æ–≥–æ NDR-lite):**
- –ù–µ—Ç IDS/Suricata (–Ω–µ—Ç –∞–ª–µ—Ä—Ç–æ–≤ –ø–æ —Å–∏–≥–Ω–∞—Ç—É—Ä–∞–º)
- –ù–µ—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –∏ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤
- –ù–µ—Ç AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞
- –ù–µ—Ç attack paths –∏ blast radius
- –ù–µ—Ç ML anomaly detection

**–¶–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ:**

| –¢–∞—Ä–∏—Ñ | –•–æ—Å—Ç—ã | –¶–µ–Ω–∞/–º–µ—Å | –¶–µ–Ω–∞/–≥–æ–¥ |
|-------|-------|----------|----------|
| Discovery Free | –¥–æ 30 | 0 | 0 |
| Discovery Pro | –¥–æ 200 | 30–∫ | 324–∫ |
| Discovery Business | –¥–æ 1000 | 60–∫ | 648–∫ |

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è:** Discovery ‚Äî –≤–æ—Ä–æ–Ω–∫–∞ –≤ –ø–æ–ª–Ω—ã–π NDR-lite. –ö–ª–∏–µ–Ω—Ç –≤–∏–¥–∏—Ç –∫–∞—Ä—Ç—É, –∞ –ø–æ—Ç–æ–º: ¬´–•–æ—Ç–∏—Ç–µ —É–≤–∏–¥–µ—Ç—å –∫—Ç–æ –ø–æ —ç—Ç–æ–π –∫–∞—Ä—Ç–µ —Ö–æ–¥–∏—Ç?¬ª

**–°—Ä–æ–∫ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏:** –ù–µ–¥–µ–ª—è 7 (–ø–æ—Å–ª–µ —Ñ–∞–∑—ã 1 + –±–∞–∑–æ–≤—ã–π UI). –ú–æ–∂–Ω–æ –ø—Ä–æ–¥–∞–≤–∞—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —Å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–æ–π –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Ñ–∞–∑.

---

### üîî Telegram-–±–æ—Ç –∏ –Ω–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

–í –†–æ—Å—Å–∏–∏ Telegram ‚Äî —Ä–∞–±–æ—á–∏–π –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä –¥–ª—è 80%+ SMB. –ò–ë-—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –¥–æ–ª–∂–µ–Ω —É–∑–Ω–∞—Ç—å –æ–± –∞—Ç–∞–∫–µ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ, –∞ –Ω–µ –∫–æ–≥–¥–∞ —É—Ç—Ä–æ–º –æ—Ç–∫—Ä–æ–µ—Ç –ø–æ—á—Ç—É.

**Telegram-–±–æ—Ç:**

```
üî¥ NDR-lite | Critical Alert
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
Lateral Movement detected

WS-MARINA (10.0.1.45, –ë—É—Ö–≥–∞–ª—Ç–µ—Ä–∏—è)
  ‚Üí WS-SERGEY (10.0.1.52, IT)
  ‚Üí DC-01 (10.0.0.1, –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –¥–æ–º–µ–Ω–∞)

3 —Ö–æ–ø–∞ –∑–∞ 12 –º–∏–Ω—É—Ç
MITRE: T1021 Remote Services
Blast radius: 47 —Ö–æ—Å—Ç–æ–≤

[üîç –û—Ç–∫—Ä—ã—Ç—å –∏–Ω—Ü–∏–¥–µ–Ω—Ç]  [üîí –ò–∑–æ–ª–∏—Ä–æ–≤–∞—Ç—å —Ö–æ—Å—Ç]
[üìä –ü–æ–∫–∞–∑–∞—Ç—å blast radius]  [ü§ñ AI: –æ–±—ä—è—Å–Ω–∏]
```

**–£—Ä–æ–≤–Ω–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:**

| Severity | Telegram | Email | Webhook |
|----------|----------|-------|---------|
| Critical | ‚úÖ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ | ‚úÖ | ‚úÖ |
| High | ‚úÖ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ | ‚úÖ | ‚úÖ |
| Medium | ‚úÖ –±–∞—Ç—á/15 –º–∏–Ω | ‚úÖ | ‚úÖ |
| Low | ‚ùå (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) | ‚úÖ –¥–∞–π–¥–∂–µ—Å—Ç | ‚úÖ |
| Info | ‚ùå | ‚ùå | ‚úÖ |

**–§—É–Ω–∫—Ü–∏–∏ –±–æ—Ç–∞ (–ø–æ–º–∏–º–æ –∞–ª–µ—Ä—Ç–æ–≤):**
- `/status` ‚Äî –∫—Ä–∞—Ç–∫–∞—è —Å–≤–æ–¥–∫–∞: —Å–µ–Ω—Å–æ—Ä—ã, –∞–ª–µ—Ä—Ç—ã –∑–∞ —Å—É—Ç–∫–∏, top risk hosts
- `/blast 10.0.1.45` ‚Äî blast radius –ø—Ä—è–º–æ –≤ —á–∞—Ç
- `/top` ‚Äî top-10 —Ä–∏—Å–∫–æ–≤–∞–Ω–Ω—ã—Ö —Ö–æ—Å—Ç–æ–≤
- `/report` ‚Äî –æ—Ç–ø—Ä–∞–≤–∏—Ç—å PDF-–æ—Ç—á—ë—Ç –≤ —á–∞—Ç
- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π: ¬´–ò–∑–æ–ª–∏—Ä–æ–≤–∞—Ç—å¬ª ‚Üí –¥–æ–±–∞–≤–ª—è–µ—Ç —Ö–æ—Å—Ç –≤ —á—ë—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫ (Active Response v2)

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**

```python
# python/services/notification_service.py
from pylecular.service import Service
from pylecular.decorators import action, event
import httpx, os

class NotificationService(Service):
    name = "notification"

    def created(self):
        self.telegram_token = os.getenv("TELEGRAM_BOT_TOKEN")
        self.telegram_chat_id = os.getenv("TELEGRAM_CHAT_ID")
        self.webhooks = []  # Syslog/CEF, Slack, custom

    @event("incident.created")
    async def on_incident(self, ctx):
        severity = ctx.params["severity"]
        if severity in ("critical", "high"):
            await self.send_telegram(self.format_incident(ctx.params))
        for webhook in self.webhooks:
            await self.send_webhook(webhook, ctx.params)

    @event("ml.anomaly_detected")
    async def on_anomaly(self, ctx):
        await self.send_telegram(self.format_anomaly(ctx.params))

    async def send_telegram(self, message: str, buttons=None):
        if not self.telegram_token:
            return
        payload = {
            "chat_id": self.telegram_chat_id,
            "text": message,
            "parse_mode": "HTML"
        }
        if buttons:
            payload["reply_markup"] = {"inline_keyboard": buttons}
        async with httpx.AsyncClient() as client:
            await client.post(
                f"https://api.telegram.org/bot{self.telegram_token}/sendMessage",
                json=payload
            )

    @action()
    async def send_syslog_cef(self, ctx):
        """–û—Ç–ø—Ä–∞–≤–∫–∞ –≤ SIEM —á–µ—Ä–µ–∑ syslog/CEF"""
        event = ctx.params
        cef = self.format_cef(event)
        # UDP syslog –∫ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω–æ–º—É SIEM
        # ...
```

**Syslog/CEF Export (–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å SIEM):**

–î–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤ —É –∫–æ—Ç–æ—Ä—ã—Ö —É–∂–µ –µ—Å—Ç—å SIEM (MaxPatrol, Splunk, ArcSight) ‚Äî –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –∞–ª–µ—Ä—Ç—ã –∏ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ:

```
CEF:0|NDR-lite|NDR|1.0|lateral_movement|Lateral Movement Chain|9|
src=10.0.1.45 dst=10.0.0.1 spt=445 dpt=445
cs1Label=AttackPath cs1=WS-12‚ÜíWS-05‚ÜíDC-01
cs2Label=BlastRadius cs2=47
cs3Label=MitreTactic cs3=TA0008
```

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã: CEF (ArcSight, QRadar), Syslog (RFC 5424), JSON (Splunk HEC, MaxPatrol).

---

### üéØ "–ß—Ç–æ –µ—Å–ª–∏?" ‚Äî —Å–∏–º—É–ª—è—Ü–∏—è –∞—Ç–∞–∫ –Ω–∞ –≥—Ä–∞—Ñ–µ (Killer Feature)

–£–Ω–∏–∫–∞–ª—å–Ω–∞—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å, –∫–æ—Ç–æ—Ä–æ–π –Ω–µ—Ç –Ω–∏ —É –æ–¥–Ω–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞ –≤ —Ü–µ–Ω–æ–≤–æ–º —Å–µ–≥–º–µ–Ω—Ç–µ –¥–æ 10–ú —Ä—É–±. –£—Ä–æ–≤–µ–Ω—å XM Cyber / Darktrace, –¥–æ—Å—Ç—É–ø–Ω—ã–π –∑–∞ 10% —Ü–µ–Ω—ã.

**–ö–æ–Ω—Ü–µ–ø—Ü–∏—è:** –£ –Ω–∞—Å –µ—Å—Ç—å –ø–æ–ª–Ω—ã–π –≥—Ä–∞—Ñ —Å–µ—Ç–∏ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ —Å–≤—è–∑—è–º–∏. –ú—ã –º–æ–∂–µ–º —Å–º–æ–¥–µ–ª–∏—Ä–æ–≤–∞—Ç—å –ª—é–±–æ–π —Å—Ü–µ–Ω–∞—Ä–∏–π –±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–π –∞—Ç–∞–∫–∏ ‚Äî —á–∏—Å—Ç–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –Ω–∞ –≥—Ä–∞—Ñ–µ.

**–°—Ü–µ–Ω–∞—Ä–∏–π 1: "–ß—Ç–æ –±—É–¥–µ—Ç, –µ—Å–ª–∏ –≤–∑–ª–æ–º–∞—é—Ç —Ö–æ—Å—Ç X?"**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  üéØ Attack Simulation: WS-MARINA (10.0.1.45)            ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  ‚îå‚îÄ CURRENT STATE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ  Blast radius: 47 —Ö–æ—Å—Ç–æ–≤ (70% —Å–µ—Ç–∏)               ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  Paths to DC: 3 (min 2 hops, ~15 min estimated)   ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  Paths to 1C: 2 (min 1 hop, ~5 min estimated)     ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  Critical assets at risk: DC-01, DB-1C, FileServ   ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  Segmentation score: 34/100                        ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                                                           ‚îÇ
‚îÇ  ATTACK GRAPH:                                           ‚îÇ
‚îÇ  [WS-MARINA] ‚îÄ‚îÄSMB‚îÄ‚îÄ‚Üí [WS-SERGEY] ‚îÄ‚îÄRDP‚îÄ‚îÄ‚Üí [DC-01]     ‚îÇ
‚îÇ       ‚îÇ                     ‚îÇ                             ‚îÇ
‚îÇ       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄHTTP‚îÄ‚îÄ‚Üí [1C-SRV] ‚îÄ‚îÄSQL‚îÄ‚îÄ‚Üí [DB-1C]          ‚îÇ
‚îÇ                                                           ‚îÇ
‚îÇ  üìä Timeline estimate (based on avg lateral speed):      ‚îÇ
‚îÇ  T+0min: Initial compromise                              ‚îÇ
‚îÇ  T+5min: Reach 1C server (1 hop, port 80 open)          ‚îÇ
‚îÇ  T+15min: Reach Domain Controller (2 hops)               ‚îÇ
‚îÇ  T+20min: Full domain compromise                         ‚îÇ
‚îÇ                                                           ‚îÇ
‚îÇ  [‚ñ∂ Simulate mitigation]  [üìã Export report]             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–°—Ü–µ–Ω–∞—Ä–∏–π 2: "–ß—Ç–æ –∏–∑–º–µ–Ω–∏—Ç—Å—è, –µ—Å–ª–∏ –º—ã –∑–∞–∫—Ä–æ–µ–º –ø–æ—Ä—Ç/—Å–≤—è–∑—å?"**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  üõ° Mitigation Simulation                                ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  Proposed change: Block SMB (445) –ë—É—Ö–≥–∞–ª—Ç–µ—Ä–∏—è‚Üí–°–µ—Ä–≤–µ—Ä–Ω–∞—è  ‚îÇ
‚îÇ                                                           ‚îÇ
‚îÇ  BEFORE:                    AFTER:                        ‚îÇ
‚îÇ  Blast radius: 47 hosts    Blast radius: 12 hosts ‚úÖ     ‚îÇ
‚îÇ  Paths to DC: 3            Paths to DC: 1 (via VPN) ‚úÖ   ‚îÇ
‚îÇ  Paths to 1C: 2            Paths to 1C: 0 ‚úÖ             ‚îÇ
‚îÇ  Seg. score: 34/100        Seg. score: 71/100 ‚úÖ         ‚îÇ
‚îÇ                                                           ‚îÇ
‚îÇ  ‚ö° Impact: -74% blast radius, -67% attack paths         ‚îÇ
‚îÇ                                                           ‚îÇ
‚îÇ  ‚ö†Ô∏è  Side effects:                                       ‚îÇ
‚îÇ  - –ë—É—Ö–≥–∞–ª—Ç–µ—Ä–∏—è –ø–æ—Ç–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø –∫ \\filesrv\shared        ‚îÇ
‚îÇ  - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç—å —á–µ—Ä–µ–∑ —Ñ–∞–π–ª–æ–≤—ã–π —à–ª—é–∑       ‚îÇ
‚îÇ                                                           ‚îÇ
‚îÇ  [Apply as rule]  [Try another change]  [üìã Report]      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è (—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ graph-analytics):**

```javascript
// server/services/graph-analytics.service.js ‚Äî –Ω–æ–≤—ã–µ actions

    async simulateCompromise(ctx) {
        const { ip } = ctx.params;
        // 1. Blast radius –æ—Ç —ç—Ç–æ–≥–æ —Ö–æ—Å—Ç–∞
        const blast = await this.actions.blastRadius({ ip });
        // 2. –í—Å–µ shortest paths –¥–æ critical assets
        const criticals = await this.getCriticalAssets();
        const paths = await Promise.all(
            criticals.map(c => this.actions.attackPath({
                from: ip, to: c.ip
            }))
        );
        // 3. Estimated timeline (hops √ó avg lateral time)
        const timeline = this.estimateTimeline(paths);
        // 4. Current segmentation score
        const segScore = await this.actions.segmentationScore({});

        return { blast, paths, timeline, segScore, criticals };
    },

    async simulateMitigation(ctx) {
        const { changes } = ctx.params;
        // changes: [{ type: "block_port", from_subnet: "...",
        //            to_subnet: "...", port: 445 }]

        // 1. –°–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –∫–æ–ø–∏—é –≥—Ä–∞—Ñ–∞ –±–µ–∑ —É–∫–∞–∑–∞–Ω–Ω—ã—Ö —Å–≤—è–∑–µ–π
        const virtualGraph = await this.cloneGraphWithout(changes);
        // 2. –ü–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å blast radius, paths, segmentation
        const before = await this.currentMetrics();
        const after = await this.metricsOnVirtual(virtualGraph);
        // 3. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å side effects (—á—Ç–æ —Å–ª–æ–º–∞–µ—Ç—Å—è)
        const sideEffects = this.detectSideEffects(changes);

        return { before, after, improvement: this.diff(before, after),
                 sideEffects };
    },

    async segmentationScore(ctx) {
        // –ú–µ—Ç—Ä–∏–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ —Å–µ—Ç–∏ (0-100)
        const metrics = {};
        // Cross-segment connections (–º–µ–Ω—å—à–µ = –ª—É—á—à–µ)
        metrics.crossSegment = await this.countCrossSegmentEdges();
        // Avg shortest path to critical (–±–æ–ª—å—à–µ = –ª—É—á—à–µ)
        metrics.avgPathToCritical = await this.avgPathLength();
        // Bottleneck nodes (—Ö–æ—Å—Ç—ã-–º–æ—Å—Ç—ã –º–µ–∂–¥—É —Å–µ–≥–º–µ–Ω—Ç–∞–º–∏)
        metrics.bottlenecks = await this.findBottlenecks();
        // Open high-risk ports across segments
        metrics.riskyPorts = await this.crossSegmentPorts([445, 3389, 22, 23]);

        const score = this.calculateScore(metrics);
        return {
            score,
            metrics,
            recommendations: this.generateRecommendations(metrics)
        };
    }
```

**Network Segmentation Score (–µ–∂–µ–¥–Ω–µ–≤–Ω–∞—è –æ—Ü–µ–Ω–∫–∞, 0-100):**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  üõ° Network Segmentation Score                           ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                           ‚îÇ
‚îÇ  Today: 34 / 100    [‚ñì‚ñì‚ñì‚ñì‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë]    Poor            ‚îÇ
‚îÇ  7d ago: 28 / 100   Trend: ‚Üë +6                         ‚îÇ
‚îÇ                                                           ‚îÇ
‚îÇ  BREAKDOWN:                                               ‚îÇ
‚îÇ  Cross-segment flows: 142 (target: <20)     12/30 pts   ‚îÇ
‚îÇ  Path to critical:    avg 1.8 hops (‚â•3)     8/25 pts    ‚îÇ
‚îÇ  Bottleneck nodes:    3 single points       6/20 pts    ‚îÇ
‚îÇ  Risky open ports:    SMB=12, RDP=8         8/25 pts    ‚îÇ
‚îÇ                                                           ‚îÇ
‚îÇ  TOP-3 IMPROVEMENTS:                                      ‚îÇ
‚îÇ  1. Block SMB (445) –ë—É—Ö–≥–∞–ª—Ç–µ—Ä–∏—è‚Üí–°–µ—Ä–≤–µ—Ä–Ω–∞—è  ‚Üí +18 pts    ‚îÇ
‚îÇ  2. Restrict RDP to jump-host only          ‚Üí +12 pts   ‚îÇ
‚îÇ  3. Isolate IoT VLAN from Internal          ‚Üí +9 pts    ‚îÇ
‚îÇ                                                           ‚îÇ
‚îÇ  Total potential: 34 ‚Üí 73  (+39 pts)                     ‚îÇ
‚îÇ                                                           ‚îÇ
‚îÇ  [‚ñ∂ Simulate #1]  [‚ñ∂ Simulate all]  [üìã Report]         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

Score –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ. –¢—Ä–µ–Ω–¥ –∑–∞ –Ω–µ–¥–µ–ª—é/–º–µ—Å—è—Ü. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ ‚Äî –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ: –∫–∞–∫–æ–π –ø–æ—Ä—Ç –∑–∞–∫—Ä—ã—Ç—å, –∫–∞–∫–æ–π VLAN –∏–∑–æ–ª–∏—Ä–æ–≤–∞—Ç—å, —Å –æ—Ü–µ–Ω–∫–æ–π —ç—Ñ—Ñ–µ–∫—Ç–∞ –≤ –±–∞–ª–ª–∞—Ö. –ì–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏—è: –∫–ª–∏–µ–Ω—Ç –≤–∏–¥–∏—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å, –º–æ—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω —É–ª—É—á—à–∞—Ç—å.

---

### üìã Compliance-–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –æ—Ç—á—ë—Ç–æ–≤

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è —Ä–µ–≥—É–ª—è—Ç–æ—Ä–æ–≤ –∏ –∞—É–¥–∏—Ç–æ—Ä–æ–≤. –î–∞–Ω–Ω—ã–µ –∏–∑ –≥—Ä–∞—Ñ–∞ + ClickHouse + AI –¥–ª—è —Ç–µ–∫—Å—Ç–æ–≤.

**–®–∞–±–ª–æ–Ω—ã –æ—Ç—á—ë—Ç–æ–≤:**

| –û—Ç—á—ë—Ç | –°—Ç–∞–Ω–¥–∞—Ä—Ç | –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö | –§–æ—Ä–º–∞—Ç |
|-------|----------|-----------------|--------|
| –ê–∫—Ç –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö –∞–∫—Ç–∏–≤–æ–≤ | 187-–§–ó (–ö–ò–ò) | –ì—Ä–∞—Ñ: –≤—Å–µ —Ö–æ—Å—Ç—ã, —Å–µ—Ä–≤–∏—Å—ã, —Å–≤—è–∑–∏ | PDF, DOCX |
| –°—Ö–µ–º–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤ | –ì–û–°–¢ 57580 | –ì—Ä–∞—Ñ: –º–∞—Ç—Ä–∏—Ü–∞ —Å–≤—è–∑–µ–π –º–µ–∂–¥—É –ø–æ–¥—Å–µ—Ç—è–º–∏ | PDF + SVG |
| –ñ—É—Ä–Ω–∞–ª –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤ –ò–ë | –õ—é–±–æ–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç | ClickHouse: –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã, actions, timeline | PDF, CSV |
| –û—Ü–µ–Ω–∫–∞ –∑–∞—â–∏—â—ë–Ω–Ω–æ—Å—Ç–∏ —Å–µ—Ç–∏ | –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∞—É–¥–∏—Ç | –ì—Ä–∞—Ñ: segmentation score, risk scores, paths | PDF |
| –û—Ç—á—ë—Ç –æ —Å–µ—Ç–µ–≤—ã—Ö –∞–Ω–æ–º–∞–ª–∏—è—Ö | –î–ª—è —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞ | ML: –∞–Ω–æ–º–∞–ª–∏–∏, —Ç—Ä–µ–Ω–¥—ã, top risks | PDF |
| –ö–∞—Ä—Ç–æ—á–∫–∞ –∫—Ä–∏—Ç–∏—á–Ω–æ–≥–æ –∞–∫—Ç–∏–≤–∞ | 187-–§–ó –∫–∞—Ç–µ–≥–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ | –ì—Ä–∞—Ñ: blast radius, paths, –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ | PDF |

**–ü—Ä–∏–º–µ—Ä: –ê–∫—Ç –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏–∏ (187-–§–ó)**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  –ê–ö–¢                                             ‚îÇ
‚îÇ  –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö –∞–∫—Ç–∏–≤–æ–≤           ‚îÇ
‚îÇ  –û–û–û "–ö–ª–∏–µ–Ω—Ç"                                    ‚îÇ
‚îÇ  –æ—Ç 15.01.2025                                   ‚îÇ
‚îÇ                                                   ‚îÇ
‚îÇ  1. –û–±—â–∏–µ —Å–≤–µ–¥–µ–Ω–∏—è                               ‚îÇ
‚îÇ  –û–±—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≤–µ–¥–µ–Ω–æ —Å–∏—Å—Ç–µ–º–æ–π NDR-lite v1.0   ‚îÇ
‚îÇ  –ü–µ—Ä–∏–æ–¥: 01.01.2025 ‚Äî 15.01.2025                ‚îÇ
‚îÇ  –ú–µ—Ç–æ–¥: –ø–∞—Å—Å–∏–≤–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞        ‚îÇ
‚îÇ                                                   ‚îÇ
‚îÇ  2. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏–∏                    ‚îÇ
‚îÇ  –û–±–Ω–∞—Ä—É–∂–µ–Ω–æ –∞–∫—Ç–∏–≤–æ–≤: 234                         ‚îÇ
‚îÇ  - –°–µ—Ä–≤–µ—Ä—ã: 18                                    ‚îÇ
‚îÇ  - –†–∞–±–æ—á–∏–µ —Å—Ç–∞–Ω—Ü–∏–∏: 156                          ‚îÇ
‚îÇ  - –°–µ—Ç–µ–≤–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ: 12                      ‚îÇ
‚îÇ  - IoT/–ø—Ä–æ—á–µ–µ: 48                                ‚îÇ
‚îÇ                                                   ‚îÇ
‚îÇ  3. –°–µ—Ç–µ–≤–∞—è —Ç–æ–ø–æ–ª–æ–≥–∏—è                            ‚îÇ
‚îÇ  [SVG-–¥–∏–∞–≥—Ä–∞–º–º–∞ –∏–∑ Cytoscape.js]                 ‚îÇ
‚îÇ                                                   ‚îÇ
‚îÇ  4. –ú–∞—Ç—Ä–∏—Ü–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤               ‚îÇ
‚îÇ  [–¢–∞–±–ª–∏—Ü–∞: –ø–æ–¥—Å–µ—Ç—å‚Üí–ø–æ–¥—Å–µ—Ç—å, –ø–æ—Ä—Ç—ã, –æ–±—ä—ë–º]        ‚îÇ
‚îÇ                                                   ‚îÇ
‚îÇ  5. –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –∞–∫—Ç–∏–≤—ã                             ‚îÇ
‚îÇ  [–¢–∞–±–ª–∏—Ü–∞: —Ö–æ—Å—Ç, —Ä–æ–ª—å, blast radius, risk score] ‚îÇ
‚îÇ                                                   ‚îÇ
‚îÇ  6. –í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è                    ‚îÇ
‚îÇ  - 3 —Ö–æ—Å—Ç–∞ –±–µ–∑ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–∞ (–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ –ø–æ OS+UA)  ‚îÇ
‚îÇ  - 12 cross-segment SMB –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏        ‚îÇ
‚îÇ  - 2 —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Å —É—Å—Ç–∞—Ä–µ–≤—à–∏–º TLS 1.0             ‚îÇ
‚îÇ                                                   ‚îÇ
‚îÇ  –ü–æ–¥–ø–∏—Å—å: _____________ / AI-assisted report     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**

```javascript
// server/services/compliance-reports.service.js
module.exports = {
    name: "compliance-reports",
    dependencies: ["graph-analytics", "reports"],

    actions: {
        async generateInventoryAct(ctx) {
            const topology = await ctx.call("graph-analytics.topology", {});
            const classified = this.classifyAssets(topology);
            const flows = await ctx.call("graph-analytics.flowMatrix", {});
            const criticals = await ctx.call("graph-analytics.criticalAssets", {});
            // AI –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –≤—ã–≤–æ–¥—ã –∏ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è
            const findings = await ctx.call("llm.analyzeCompliance", {
                assets: classified, flows, criticals,
                standard: "187-fz"
            });
            return await ctx.call("reports.render", {
                template: "inventory-act-187fz",
                data: { classified, flows, criticals, findings,
                        orgName: ctx.params.orgName, date: new Date() }
            });
        },

        async generateSegmentationReport(ctx) { /* ... */ },
        async generateIncidentJournal(ctx) { /* ... */ },
        async generateAssetCard(ctx) { /* ... */ },
    }
};
```

**–ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è:** Compliance-–æ—Ç—á—ë—Ç—ã –¥–æ—Å—Ç—É–ø–Ω—ã –≤ Pro-—Ç–∞—Ä–∏—Ñ–∞—Ö. –û—Ç–¥–µ–ª—å–Ω–∞—è –ø–æ–∫—É–ø–∫–∞ —Ä–∞–∑–æ–≤–æ–≥–æ –∞—É–¥–∏—Ç-–æ—Ç—á—ë—Ç–∞ ‚Äî 50-100–∫ —Ä—É–±. –ö–æ–Ω—Å–∞–ª—Ç–µ—Ä—ã –±–µ—Ä—É—Ç –∑–∞ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π –∞—É–¥–∏—Ç 500–∫-2–ú.

---

### üè¢ Active Directory / LDAP –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

90%+ SMB –∏—Å–ø–æ–ª—å–∑—É—é—Ç AD. –ë–µ–∑ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ ‚Äî IP-–∞–¥—Ä–µ—Å–∞. –° –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π ‚Äî –∏–º–µ–Ω–∞ –ª—é–¥–µ–π, –æ—Ç–¥–µ–ª—ã, –¥–æ–ª–∂–Ω–æ—Å—Ç–∏.

**–ß—Ç–æ –¥–∞—ë—Ç AD-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**

| –ë–µ–∑ AD | –° AD |
|--------|------|
| 10.0.1.45 brute force –Ω–∞ 10.0.0.1 | **–ú–∞—Ä–∏–Ω–∞ –ò–≤–∞–Ω–æ–≤–∞** (–±—É—Ö–≥–∞–ª—Ç–µ—Ä–∏—è) –ø–æ–¥–±–∏—Ä–∞–µ—Ç –ø–∞—Ä–æ–ª—å –∫ **–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—É –¥–æ–º–µ–Ω–∞** |
| –•–æ—Å—Ç risk score 87 | **WS-MARINA** (–ú–∞—Ä–∏–Ω–∞ –ò–≤–∞–Ω–æ–≤–∞, –±—É—Ö–≥–∞–ª—Ç–µ—Ä) ‚Äî risk 87, Domain Users, –ë—É—Ö–≥–∞–ª—Ç–µ—Ä–∏—è |
| Lateral movement: 3 —Ö–æ–ø–∞ | **–ú–∞—Ä–∏–Ω–∞ ‚Üí –°–µ—Ä–≥–µ–π (IT) ‚Üí –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –¥–æ–º–µ–Ω–∞** |
| Blast radius: 47 —Ö–æ—Å—Ç–æ–≤ | Blast radius: **47 —Ö–æ—Å—Ç–æ–≤, 3 –æ—Ç–¥–µ–ª–∞, –≤–∫–ª—é—á–∞—è –≤—Å—é –±—É—Ö–≥–∞–ª—Ç–µ—Ä–∏—é** |

**–û–±–æ–≥–∞—â–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∞:**

```graphql
# –ù–æ–≤—ã–µ –ø—Ä–µ–¥–∏–∫–∞—Ç—ã –≤ Dgraph
host.ad_username: string @index(exact, term) .
host.ad_department: string @index(exact) .
host.ad_groups: [string] @index(term) .
host.ad_last_logon: datetime .
host.ad_is_admin: bool @index(bool) .

type ADUser {
    ad.username ad.display_name ad.department
    ad.groups ad.last_logon ad.is_admin
    ad.logged_on_hosts  # [uid] ‚Üí Host
}
```

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**

```python
# python/services/ad_sync_service.py
from pylecular.service import Service
from pylecular.decorators import action, event
import ldap3, os, asyncio

class ADSyncService(Service):
    name = "ad-sync"

    def created(self):
        self.ldap_server = os.getenv("AD_SERVER", "ldap://dc01.company.local")
        self.ldap_user = os.getenv("AD_BIND_USER")
        self.ldap_password = os.getenv("AD_BIND_PASSWORD")
        self.base_dn = os.getenv("AD_BASE_DN", "DC=company,DC=local")
        self.sync_interval = 3600  # 1 —á–∞—Å

    @action()
    async def sync(self, ctx):
        """–ü–æ–ª–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è AD ‚Üí –≥—Ä–∞—Ñ"""
        server = ldap3.Server(self.ldap_server, get_info=ldap3.ALL)
        conn = ldap3.Connection(server, self.ldap_user, self.ldap_password)
        conn.bind()

        # –ö–æ–º–ø—å—é—Ç–µ—Ä—ã
        conn.search(self.base_dn, '(objectClass=computer)',
                     attributes=['cn', 'dNSHostName', 'operatingSystem',
                                'lastLogonTimestamp', 'memberOf'])
        for entry in conn.entries:
            await ctx.emit("ad.computer_synced", {
                "hostname": str(entry.cn),
                "dns": str(entry.dNSHostName),
                "os": str(entry.operatingSystem),
                "groups": [str(g) for g in entry.memberOf]
            })

        # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
        conn.search(self.base_dn, '(objectClass=user)',
                     attributes=['sAMAccountName', 'displayName',
                                'department', 'memberOf', 'lastLogon'])
        for entry in conn.entries:
            is_admin = any('Domain Admins' in str(g) for g in entry.memberOf)
            await ctx.emit("ad.user_synced", {
                "username": str(entry.sAMAccountName),
                "display_name": str(entry.displayName),
                "department": str(entry.department),
                "groups": [str(g) for g in entry.memberOf],
                "is_admin": is_admin
            })

        conn.unbind()
        return {"computers": len(conn.entries), "status": "synced"}

    async def started(self):
        """–ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–∞–∂–¥—ã–π —á–∞—Å"""
        while True:
            try:
                await self.actions["sync"]({})
                self.logger.info("AD sync completed")
            except Exception as e:
                self.logger.error(f"AD sync failed: {e}")
            await asyncio.sleep(self.sync_interval)
```

**AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º AD:**

```
–ë—ã–ª–æ (–±–µ–∑ AD):
"–•–æ—Å—Ç 10.0.1.45 —É—Å—Ç–∞–Ω–æ–≤–∏–ª 3 –Ω–æ–≤—ã—Ö SMB-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä–Ω–æ–º—É —Å–µ–≥–º–µ–Ω—Ç—É"

–°—Ç–∞–ª–æ (—Å AD):
"–ö–æ–º–ø—å—é—Ç–µ—Ä –ú–∞—Ä–∏–Ω—ã –ò–≤–∞–Ω–æ–≤–æ–π –∏–∑ –±—É—Ö–≥–∞–ª—Ç–µ—Ä–∏–∏ –Ω–∞—á–∞–ª –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä–∞–º,
 –∫ –∫–æ—Ç–æ—Ä—ã–º —Ä–∞–Ω—å—à–µ –Ω–µ –æ–±—Ä–∞—â–∞–ª—Å—è: —Ñ–∞–π–ª–æ–≤—ã–π —Å–µ—Ä–≤–µ—Ä IT-–æ—Ç–¥–µ–ª–∞, —Å–µ—Ä–≤–µ—Ä 1–°
 –∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –¥–æ–º–µ–Ω–∞. –ú–∞—Ä–∏–Ω–∞ ‚Äî –æ–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±–µ–∑ –∞–¥–º–∏–Ω-–ø—Ä–∞–≤.
 –≠—Ç–æ –º–æ–∂–µ—Ç –æ–∑–Ω–∞—á–∞—Ç—å –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—é –µ—ë —É—á—ë—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏."
```

---

### üîí JA3/JA4 TLS Fingerprinting

–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –ü–û –ø–æ TLS-—Ö—ç–Ω–¥—à–µ–π–∫—É ‚Äî –¥–∞–∂–µ –≤ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–º —Ç—Ä–∞—Ñ–∏–∫–µ. Zeek –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç JA3 –∏–∑ –∫–æ—Ä–æ–±–∫–∏.

**–ß—Ç–æ –¥–µ—Ç–µ–∫—Ç–∏—Ä—É–µ—Ç:**

| JA3 Hash | –ö–ª–∏–µ–Ω—Ç | Threat |
|----------|--------|--------|
| `72a589da586844d7f0818ce684948eea` | Cobalt Strike Beacon | üî¥ Critical |
| `e7d705a3286e19ea42f587b344ee6865` | Metasploit Meterpreter | üî¥ Critical |
| `4d7a28d6f2263ed61de88ca66eb011e3` | Mimikatz | üî¥ Critical |
| `b32309a26951912be7dba376398abc3b` | curl (Linux) | üü° Suspicious |
| known hashes | Chrome, Firefox, Edge | üü¢ Normal |

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è ‚Äî –ø—Ä–∞–≤–∏–ª–æ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏:**

```javascript
// server/correlation/event-rules/ja3-fingerprint.rule.js
class JA3FingerprintRule {
    constructor() {
        this.maliciousJA3 = loadJA3Database();  // abuse.ch JA3 feed
        this.baselineJA3 = new Map();
    }

    async evaluate(event) {
        if (!event.ja3_hash) return null;

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ feed –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö JA3
        const known = this.maliciousJA3.get(event.ja3_hash);
        if (known) {
            return {
                type: "malicious_tls_client",
                severity: "critical",
                description: `TLS client matches ${known.name} fingerprint`,
                mitre: "T1071.001",
                src_ip: event.src_ip,
                tool: known.name
            };
        }

        // –ù–æ–≤—ã–π TLS fingerprint –Ω–µ –∏–∑ baseline
        const hostJA3 = this.baselineJA3.get(event.src_ip) || new Set();
        if (!hostJA3.has(event.ja3_hash) && this.isAfterBaseline) {
            return {
                type: "new_tls_client", severity: "medium",
                mitre: "T1059", src_ip: event.src_ip
            };
        }
        return null;
    }
}
```

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –≤ ClickHouse:**

```sql
-- –î–æ–±–∞–≤–∏—Ç—å –≤ —Ç–∞–±–ª–∏—Ü—É events
ja3_hash        String DEFAULT '',
ja3s_hash       String DEFAULT '',
ja4_hash        String DEFAULT '',
INDEX idx_ja3 ja3_hash TYPE bloom_filter GRANULARITY 4,
```

---

### üåê Threat Intelligence Feeds

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–∑ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö IP, –¥–æ–º–µ–Ω–æ–≤, JA3-—Ö—ç—à–µ–π, URL. –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ —Ñ–∏–¥—ã ‚Äî –±–µ–∑ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ API-–∫–ª—é—á–µ–π. –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ —Ñ–∏–¥—ã (–§–∏–Ω–¶–ï–†–¢, –ì–æ—Å–°–û–ü–ö–ê) ‚Äî —á–µ—Ä–µ–∑ credentials –∫–ª–∏–µ–Ω—Ç–∞.

**–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ —Ñ–∏–¥—ã (–≤—Å—Ç—Ä–æ–µ–Ω—ã, —Ä–∞–±–æ—Ç–∞—é—Ç –∏–∑ –∫–æ—Ä–æ–±–∫–∏):**

| –§–∏–¥ | –ß—Ç–æ –¥–∞—ë—Ç | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ NDR-lite |
|-----|----------|------------|--------------------------|
| **abuse.ch Feodo Tracker** | IP-–∞–¥—Ä–µ—Å–∞ C2 –±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö —Ç—Ä–æ—è–Ω–æ–≤ (Emotet, Dridex, TrickBot, Qakbot) | –∫–∞–∂–¥—ã–π —á–∞—Å | –ü—Ä–∞–≤–∏–ª–æ #4 C2 Detection ‚Äî –º–∞—Ç—á src/dst IP |
| **abuse.ch SSLBL** | JA3 —Ö—ç—à–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö TLS-–∫–ª–∏–µ–Ω—Ç–æ–≤ (Cobalt Strike, AsyncRAT, Metasploit) | –∫–∞–∂–¥—ã–π —á–∞—Å | –ü—Ä–∞–≤–∏–ª–æ #11 JA3 Malicious ‚Äî –ø—Ä—è–º–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –≤ rule |
| **abuse.ch ThreatFox** | –°–º–µ—à–∞–Ω–Ω—ã–µ IoC: IP, –¥–æ–º–µ–Ω—ã, JA3, URL, —Ö—ç—à–∏ | –∫–∞–∂–¥—ã–π —á–∞—Å | –í—Å–µ –ø—Ä–∞–≤–∏–ª–∞ ‚Äî –µ–¥–∏–Ω—ã–π API |
| **abuse.ch URLhaus** | URL-–∞–¥—Ä–µ—Å–∞ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –º–∞–ª–≤–∞—Ä–∏ | 5 –º–∏–Ω | –ú–∞—Ç—á —Å HTTP-–ª–æ–≥–∞–º–∏ Zeek |
| **AlienVault OTX** | IoC –æ—Ç —Å–æ–æ–±—â–µ—Å—Ç–≤–∞ (IP, domain, hash, URL) | –∫–∞–∂–¥—ã–π —á–∞—Å | –†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ (API key –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π) |
| **Blocklist.de** | IP-–∞–¥—Ä–µ—Å–∞ brute-force –∞—Ç–∞–∫—É—é—â–∏—Ö | –µ–∂–µ–¥–Ω–µ–≤–Ω–æ | –û–±–æ–≥–∞—â–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª–∞ #2 Brute Force |
| **Spamhaus DROP** | Hijacked IP ranges (—Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–¥—Å–µ—Ç–∏) | –µ–∂–µ–¥–Ω–µ–≤–Ω–æ | –ê–ª–µ—Ä—Ç –ø—Ä–∏ –ª—é–±–æ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–∏ —Å DROP-range |
| **OpenPhish** | –§–∏—à–∏–Ω–≥–æ–≤—ã–µ URL | –µ–∂–µ–¥–Ω–µ–≤–Ω–æ | –ú–∞—Ç—á —Å HTTP/DNS –ª–æ–≥–∞–º–∏ |

**–ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ —Ñ–∏–¥—ã (—á–µ—Ä–µ–∑ STIX/TAXII –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä):**

| –§–∏–¥ | –ö—Ç–æ –ø–æ–ª—É—á–∞–µ—Ç | –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ | –ß—Ç–æ –¥–∞—ë—Ç |
|-----|-------------|-------------|----------|
| **–§–∏–Ω–¶–ï–†–¢ (–ë–∞–Ω–∫ –†–æ—Å—Å–∏–∏)** | –ë–∞–Ω–∫–∏, –ù–§–û, –ø–ª–∞—Ç—ë–∂–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã | Credentials –∫–ª–∏–µ–Ω—Ç–∞ —á–µ—Ä–µ–∑ –ø–æ—Ä—Ç–∞–ª –§–∏–Ω–¶–ï–†–¢ | IoC –∞—Ç–∞–∫ –Ω–∞ —Ñ–∏–Ω—Å–µ–∫—Ç–æ—Ä –†–§ |
| **–ì–æ—Å–°–û–ü–ö–ê / –ù–ö–¶–ö–ò** | –°—É–±—ä–µ–∫—Ç—ã –ö–ò–ò (187-–§–ó) | –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ì–æ—Å–°–û–ü–ö–ê | IoC –¥–ª—è –ö–ò–ò + –¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω–∏–π –æ–±–º–µ–Ω –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞–º–∏ |
| **Kaspersky TIP** | –ö–ª–∏–µ–Ω—Ç—ã Kaspersky | –õ–∏—Ü–µ–Ω–∑–∏—è Kaspersky | –ì–ª–æ–±–∞–ª—å–Ω—ã–µ IoC –æ—Ç KSN |
| **BI.ZONE ThreatIntelligence** | –ö–ª–∏–µ–Ω—Ç—ã BI.ZONE | –ü–æ–¥–ø–∏—Å–∫–∞ | IoC —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞ RU-—Å–µ–≥–º–µ–Ω—Ç |
| **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ STIX/TAXII** | –õ—é–±–æ–π | –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π URL + credentials | –õ—é–±–æ–π STIX/TAXII-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ |

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**

```python
# python/services/threat_intel_service.py
from pylecular.service import Service
from pylecular.decorators import action, event
import httpx, csv, io, asyncio, os

class ThreatIntelService(Service):
    name = "threat-intel"

    FEEDS = {
        "feodo_c2": {
            "url": "https://feodotracker.abuse.ch/downloads/ipblocklist_recommended.txt",
            "type": "ip", "interval": 3600
        },
        "sslbl_ja3": {
            "url": "https://sslbl.abuse.ch/blacklist/ja3_fingerprints.csv",
            "type": "ja3", "interval": 3600
        },
        "threatfox": {
            "url": "https://threatfox-api.abuse.ch/api/v1/",
            "type": "mixed", "interval": 3600
        },
        "urlhaus": {
            "url": "https://urlhaus-api.abuse.ch/v1/urls/recent/",
            "type": "url", "interval": 300
        },
        "blocklist_de": {
            "url": "https://lists.blocklist.de/lists/all.txt",
            "type": "ip", "interval": 86400
        },
        "spamhaus_drop": {
            "url": "https://www.spamhaus.org/drop/drop.txt",
            "type": "cidr", "interval": 86400
        }
    }

    def created(self):
        self.ioc_db = {
            "ip": set(),         # C2, brute-force IPs
            "domain": set(),     # –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ –¥–æ–º–µ–Ω—ã
            "ja3": {},           # JA3 hash ‚Üí {tool, source}
            "url": set(),        # –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ URL
            "cidr": [],          # hijacked –ø–æ–¥—Å–µ—Ç–∏
        }
        self.stats = {"total_ioc": 0, "last_update": None}

    @action()
    async def check_ip(self, ctx):
        """–ü—Ä–æ–≤–µ—Ä–∏—Ç—å IP –ø–æ –≤—Å–µ–º —Ñ–∏–¥–∞–º"""
        ip = ctx.params["ip"]
        if ip in self.ioc_db["ip"]:
            return {"malicious": True, "type": "ip", "source": "abuse.ch"}
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ CIDR (Spamhaus DROP)
        for cidr in self.ioc_db["cidr"]:
            if self.ip_in_cidr(ip, cidr):
                return {"malicious": True, "type": "cidr", "source": "spamhaus"}
        return {"malicious": False}

    @action()
    async def check_domain(self, ctx):
        domain = ctx.params["domain"]
        return {"malicious": domain in self.ioc_db["domain"],
                "source": "threatfox" if domain in self.ioc_db["domain"] else None}

    @action()
    async def check_ja3(self, ctx):
        ja3 = ctx.params["ja3"]
        if ja3 in self.ioc_db["ja3"]:
            info = self.ioc_db["ja3"][ja3]
            return {"malicious": True, "tool": info["tool"], "source": info["source"]}
        return {"malicious": False}

    @action()
    async def check_url(self, ctx):
        url = ctx.params["url"]
        return {"malicious": url in self.ioc_db["url"]}

    @action()
    async def get_stats(self, ctx):
        """–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö IoC"""
        return {
            "ips": len(self.ioc_db["ip"]),
            "domains": len(self.ioc_db["domain"]),
            "ja3": len(self.ioc_db["ja3"]),
            "urls": len(self.ioc_db["url"]),
            "cidrs": len(self.ioc_db["cidr"]),
            "last_update": self.stats["last_update"]
        }

    # --- Feed updaters ---

    async def update_feodo(self):
        """abuse.ch Feodo Tracker ‚Äî C2 IP-–∞–¥—Ä–µ—Å–∞"""
        async with httpx.AsyncClient() as client:
            resp = await client.get(self.FEEDS["feodo_c2"]["url"])
            ips = set()
            for line in resp.text.splitlines():
                line = line.strip()
                if line and not line.startswith("#"):
                    ips.add(line)
            self.ioc_db["ip"].update(ips)
            self.logger.info(f"Feodo C2: {len(ips)} IPs loaded")

    async def update_sslbl_ja3(self):
        """abuse.ch SSLBL ‚Äî JA3 –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö TLS-–∫–ª–∏–µ–Ω—Ç–æ–≤"""
        async with httpx.AsyncClient() as client:
            resp = await client.get(self.FEEDS["sslbl_ja3"]["url"])
            reader = csv.DictReader(
                io.StringIO(resp.text),
                fieldnames=["timestamp", "ja3_md5", "listing_reason"]
            )
            for row in reader:
                md5 = row.get("ja3_md5", "").strip()
                if md5 and not md5.startswith("#"):
                    self.ioc_db["ja3"][md5] = {
                        "tool": row.get("listing_reason", "unknown"),
                        "source": "sslbl"
                    }
            self.logger.info(f"SSLBL JA3: {len(self.ioc_db['ja3'])} fingerprints")

    async def update_threatfox(self):
        """abuse.ch ThreatFox ‚Äî —Å–º–µ—à–∞–Ω–Ω—ã–µ IoC (IP, domain, JA3)"""
        async with httpx.AsyncClient() as client:
            resp = await client.post(
                self.FEEDS["threatfox"]["url"],
                json={"query": "get_iocs", "days": 7}
            )
            data = resp.json().get("data", [])
            for ioc in data:
                ioc_type = ioc.get("ioc_type", "")
                value = ioc.get("ioc", "")
                if ioc_type == "ip:port":
                    self.ioc_db["ip"].add(value.split(":")[0])
                elif ioc_type == "domain":
                    self.ioc_db["domain"].add(value)
                elif ioc_type == "ja3_fingerprint":
                    self.ioc_db["ja3"][value] = {
                        "tool": ioc.get("malware", "unknown"),
                        "source": "threatfox"
                    }
                elif ioc_type == "url":
                    self.ioc_db["url"].add(value)
            self.logger.info(f"ThreatFox: processed {len(data)} IoCs")

    async def update_all(self):
        """–û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ —Ñ–∏–¥—ã"""
        tasks = [
            self.update_feodo(),
            self.update_sslbl_ja3(),
            self.update_threatfox(),
        ]
        await asyncio.gather(*tasks, return_exceptions=True)
        self.stats["last_update"] = datetime.utcnow().isoformat()
        total = (len(self.ioc_db["ip"]) + len(self.ioc_db["domain"])
                + len(self.ioc_db["ja3"]) + len(self.ioc_db["url"]))
        self.logger.info(f"Threat Intel updated: {total} total IoCs")
        # –£–≤–µ–¥–æ–º–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –æ–± –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏
        await self.broker.emit("threat-intel.updated", self.get_stats_sync())

    async def started(self):
        await self.update_all()
        while True:
            await asyncio.sleep(3600)
            await self.update_all()
```

**STIX/TAXII –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä (–¥–ª—è –§–∏–Ω–¶–ï–†–¢, –ì–æ—Å–°–û–ü–ö–ê, Kaspersky TIP):**

```python
# python/services/taxii_connector.py
from taxii2client.v21 import Server as TAXIIServer, Collection
import stix2

class TaxiiConnector:
    """–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π STIX/TAXII 2.1 –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä.
    –û–¥–∏–Ω —Ä–∞–∑ –Ω–∞–ø–∏—Å–∞—Ç—å ‚Äî –ø–æ–¥–∫–ª—é—á–∞–µ—Ç –§–∏–Ω–¶–ï–†–¢, –ì–æ—Å–°–û–ü–ö–ê, –ª—é–±–æ–π TAXII-–∏—Å—Ç–æ—á–Ω–∏–∫."""

    def __init__(self, url, user=None, password=None):
        self.server = TAXIIServer(url, user=user, password=password)

    async def fetch_indicators(self, collection_id=None, added_after=None):
        """–ü–æ–ª—É—á–∏—Ç—å IoC –∏–∑ TAXII-–∫–æ–ª–ª–µ–∫—Ü–∏–∏"""
        indicators = {"ip": set(), "domain": set(), "url": set(), "ja3": set()}

        for api_root in self.server.api_roots:
            for collection in api_root.collections:
                if collection_id and collection.id != collection_id:
                    continue
                # –ü–æ–ª—É—á–∞–µ–º STIX-–æ–±—ä–µ–∫—Ç—ã
                bundle = collection.get_objects(added_after=added_after)
                for obj in bundle.get("objects", []):
                    if obj["type"] == "indicator":
                        # –ü–∞—Ä—Å–∏–º STIX pattern ‚Üí –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π IoC
                        parsed = self.parse_stix_pattern(obj["pattern"])
                        for ioc_type, value in parsed:
                            if ioc_type in indicators:
                                indicators[ioc_type].add(value)

        return indicators

    def parse_stix_pattern(self, pattern):
        """[ipv4-addr:value = '1.2.3.4'] ‚Üí ('ip', '1.2.3.4')"""
        results = []
        if "ipv4-addr:value" in pattern:
            ip = pattern.split("'")[1]
            results.append(("ip", ip))
        elif "domain-name:value" in pattern:
            domain = pattern.split("'")[1]
            results.append(("domain", domain))
        elif "url:value" in pattern:
            url = pattern.split("'")[1]
            results.append(("url", url))
        return results
```

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è TAXII-–∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ (docker-compose env vars):**

```yaml
# –ö–ª–∏–µ–Ω—Ç –ø–æ–¥–∫–ª—é—á–∞–µ—Ç —Å–≤–æ–∏ —Ñ–∏–¥—ã —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
environment:
  # –§–∏–Ω–¶–ï–†–¢ (–¥–ª—è –±–∞–Ω–∫–æ–≤)
  TAXII_FINCERT_URL: https://fincert.cbr.ru/taxii2/
  TAXII_FINCERT_USER: ${FINCERT_USER:-}
  TAXII_FINCERT_PASSWORD: ${FINCERT_PASSWORD:-}
  # –ì–æ—Å–°–û–ü–ö–ê (–¥–ª—è —Å—É–±—ä–µ–∫—Ç–æ–≤ –ö–ò–ò)
  TAXII_GOSSOPKA_URL: ${GOSSOPKA_TAXII_URL:-}
  TAXII_GOSSOPKA_USER: ${GOSSOPKA_USER:-}
  TAXII_GOSSOPKA_PASSWORD: ${GOSSOPKA_PASSWORD:-}
  # –ü—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π STIX/TAXII –∏—Å—Ç–æ—á–Ω–∏–∫
  TAXII_CUSTOM_URL: ${CUSTOM_TAXII_URL:-}
  TAXII_CUSTOM_USER: ${CUSTOM_TAXII_USER:-}
  TAXII_CUSTOM_PASSWORD: ${CUSTOM_TAXII_PASSWORD:-}
```

**–ö–∞–∫ TI-—Å–µ—Ä–≤–∏—Å —Å–≤—è–∑–∞–Ω —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏:**

–ü—Ä–∞–≤–∏–ª–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –Ω–µ —Ö—Ä–∞–Ω—è—Ç IoC —Å–∞–º–∏ ‚Äî –æ–Ω–∏ –≤—ã–∑—ã–≤–∞—é—Ç `threat-intel.check_ip()`, `threat-intel.check_ja3()` –∏ —Ç.–¥. —á–µ—Ä–µ–∑ NATS. –ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Ñ–∏–¥–æ–≤ —Å–µ—Ä–≤–∏—Å —ç–º–∏—Ç–∏—Ç —Å–æ–±—ã—Ç–∏–µ `threat-intel.updated`, –ø—Ä–∞–≤–∏–ª–∞ –º–æ–≥—É—Ç –æ–±–Ω–æ–≤–∏—Ç—å –∫—ç—à.

```
–°–æ–±—ã—Ç–∏–µ (Zeek/Suricata)
    ‚îÇ
    ‚ñº
Correlation Engine ‚îÄ‚îÄ‚Üí threat-intel.check_ip("45.33.x.x")
    ‚îÇ                        ‚îÇ
    ‚îÇ                   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ                   ‚îÇ ThreatIntelService   ‚îÇ
    ‚îÇ                   ‚îÇ - abuse.ch Feodo ‚úì   ‚îÇ
    ‚îÇ                   ‚îÇ - abuse.ch SSLBL ‚úì   ‚îÇ
    ‚îÇ                   ‚îÇ - ThreatFox ‚úì        ‚îÇ
    ‚îÇ                   ‚îÇ - –§–∏–Ω–¶–ï–†–¢ (TAXII) ‚úì ‚îÇ
    ‚îÇ                   ‚îÇ - –ì–æ—Å–°–û–ü–ö–ê (TAXII) ‚úì‚îÇ
    ‚îÇ                   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
    ‚îÇ                        ‚îÇ {malicious: true, source: "feodo"}
    ‚ñº                        ‚ñº
–°–æ–∑–¥–∞—Ç—å –∏–Ω—Ü–∏–¥–µ–Ω—Ç ‚Üê C2 Detection rule #4 triggered
```

**–¢–∞—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è TI:**

| –¢–∞—Ä–∏—Ñ | –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ —Ñ–∏–¥—ã | STIX/TAXII –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä | –ö–æ–ª-–≤–æ TAXII-–∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ |
|-------|-----------------|---------------------|------------------------|
| Free | ‚úÖ abuse.ch (–≤—Å–µ) | ‚ùå | 0 |
| Pro S | ‚úÖ abuse.ch + AlienVault OTX | ‚úÖ | 1 |
| Pro M/L | ‚úÖ –í—Å–µ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ | ‚úÖ | 5 |
| Enterprise | ‚úÖ –í—Å–µ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ | ‚úÖ | ‚àû |

---

## üîç 20 –ø—Ä–∞–≤–∏–ª –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ (–æ–±–Ω–æ–≤–ª–µ–Ω–æ)

### Event-based (—Ä–µ–∞–∫—Ç–∏–≤–Ω—ã–µ, 13 –ø—Ä–∞–≤–∏–ª)

| # | –ù–∞–∑–≤–∞–Ω–∏–µ | –õ–æ–≥–∏–∫–∞ | MITRE ATT&CK |
|---|---------|--------|--------------|
| 1 | Port Scan | >20 –ø–æ—Ä—Ç–æ–≤ –æ—Ç –æ–¥–Ω–æ–≥–æ IP –∑–∞ 60—Å | T1046 Network Service Scanning |
| 2 | Brute Force | >10 –Ω–µ—É—Å–ø–µ—à–Ω—ã—Ö SSH/RDP –æ—Ç –æ–¥–Ω–æ–≥–æ IP –∑–∞ 5 –º–∏–Ω | T1110 Brute Force |
| 3 | DNS Tunnel | –°—Ä–µ–¥–Ω—è—è –¥–ª–∏–Ω–∞ DNS query >50 —Å–∏–º–≤–æ–ª–æ–≤ –∏–ª–∏ >100 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω | T1071.004 DNS |
| 4 | C2 Detection | –û–±—Ä–∞—â–µ–Ω–∏–µ –∫ IP/–¥–æ–º–µ–Ω—É –∏–∑ threat-intel —Ñ–∏–¥–æ–≤ (abuse.ch Feodo, ThreatFox, STIX/TAXII) | T1071 Application Layer Protocol |
| 5 | Data Exfiltration | >100MB –Ω–∞—Ä—É–∂—É –∑–∞ 10 –º–∏–Ω –æ—Ç –æ–¥–Ω–æ–≥–æ —Ö–æ—Å—Ç–∞ | T1048 Exfiltration |
| 6 | Suspicious UA | User-Agent —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å —Ö–∞–∫–µ—Ä—Å–∫–∏–º–∏ —Ç—É–ª–∞–º–∏ | T1071.001 Web Protocols |
| 7 | LLMNR Poison | LLMNR/NBT-NS –æ—Ç–≤–µ—Ç—ã –æ—Ç –Ω–µ-DNS —Å–µ—Ä–≤–µ—Ä–∞ | T1557.001 LLMNR/NBT-NS Poisoning |
| 8 | Fresh Domain TLS | TLS –∫ –¥–æ–º–µ–Ω—É –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–º—É <7 –¥–Ω–µ–π –Ω–∞–∑–∞–¥ | T1583.001 Domains |
| 9 | New Device | MAC-–∞–¥—Ä–µ—Å –Ω–µ –≤—Å—Ç—Ä–µ—á–∞–≤—à–∏–π—Å—è –≤ baseline | T1200 Hardware Additions |
| 10 | Volume Anomaly | Isolation Forest (Python ML) –∞–Ω–æ–º–∞–ª—å–Ω—ã–π –æ–±—ä—ë–º | TA0010 Exfiltration |
| 11 | JA3 Malicious | TLS fingerprint = Cobalt Strike / Metasploit / Mimikatz | T1071.001 Web Protocols |
| 12 | JA3 New Client | –ù–æ–≤—ã–π TLS fingerprint –Ω–∞ —Ö–æ—Å—Ç–µ, –Ω–µ –∏–∑ baseline | T1059 Command and Scripting |
| 13 | AD Off-Hours Admin | Domain Admin –ª–æ–≥–∏–Ω –≤–Ω–µ —Ä–∞–±–æ—á–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ (AD) | T1078 Valid Accounts |

### Graph-based (–ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ, 5 –ø—Ä–∞–≤–∏–ª, –ø–æ—Å–ª–µ baseline)

| # | –ù–∞–∑–≤–∞–Ω–∏–µ | –õ–æ–≥–∏–∫–∞ | MITRE ATT&CK |
|---|---------|--------|--------------|
| 14 | Lateral Movement | –¶–µ–ø–æ—á–∫–∞ ‚â•2 —Ö–æ–ø–∞ –Ω–æ–≤—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –∑–∞ <30 –º–∏–Ω | T1021 Remote Services |
| 15 | New Connections | >5 –Ω–æ–≤—ã—Ö —Å–≤—è–∑–µ–π –Ω–µ –∏–∑ baseline –∑–∞ —á–∞—Å | T1018 Remote System Discovery |
| 16 | Cross-Segment | –ü—Ä—è–º–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ DMZ‚ÜíInternal –º–∏–Ω—É—è firewall | T1090 Proxy |
| 17 | Community Anomaly | Louvain: —Ö–æ—Å—Ç —Å–º–µ–Ω–∏–ª –≥—Ä—É–ø–ø—É | TA0008 Lateral Movement |
| 18 | Critical Exposure | Path –æ—Ç external –¥–æ critical ‚â§2 —Ö–æ–ø–∞ | TA0040 Impact |

### AD-based (—Ç—Ä–µ–±—É–µ—Ç—Å—è AD-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è, 2 –ø—Ä–∞–≤–∏–ª–∞)

| # | –ù–∞–∑–≤–∞–Ω–∏–µ | –õ–æ–≥–∏–∫–∞ | MITRE ATT&CK |
|---|---------|--------|--------------|
| 19 | Multi-Host Login | –û–¥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞ ‚â•3 —Ö–æ—Å—Ç–∞—Ö –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ | T1078.002 Domain Accounts |
| 20 | Privilege Escalation | –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—É—é –≥—Ä—É–ø–ø—É AD | T1484 Group Policy Modification |


## üóÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
ndr-lite/
‚îú‚îÄ‚îÄ sensor/
‚îÇ   ‚îú‚îÄ‚îÄ install.sh
‚îÇ   ‚îú‚îÄ‚îÄ moleculer.config.js
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ collector.service.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ health.service.js
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ parsers/
‚îÇ   ‚îú‚îÄ‚îÄ suricata/
‚îÇ   ‚îú‚îÄ‚îÄ zeek/
‚îÇ   ‚îî‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ server/                          # Node.js (Moleculer)
‚îÇ   ‚îú‚îÄ‚îÄ moleculer.config.js
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api.service.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ingestion.service.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ graph-builder.service.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ graph-analytics.service.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ correlation.service.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ incidents.service.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ assets.service.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ sensors.service.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dashboard.service.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ reports.service.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ compliance-reports.service.js  # Compliance –æ—Ç—á—ë—Ç—ã (187-–§–ó, –ì–û–°–¢)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ auth.service.js
‚îÇ   ‚îú‚îÄ‚îÄ correlation/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ event-rules/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ja3-fingerprint.rule.js    # JA3/JA4 TLS fingerprinting
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ graph-rules/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ad-rules/                      # AD-based –ø—Ä–∞–≤–∏–ª–∞
‚îÇ   ‚îú‚îÄ‚îÄ reports/templates/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ incident-report.html
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ inventory-act-187fz.html       # –ê–∫—Ç –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ flow-matrix-gost57580.html     # –°—Ö–µ–º–∞ –ø–æ—Ç–æ–∫–æ–≤
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ segmentation-report.html       # –û—Ü–µ–Ω–∫–∞ –∑–∞—â–∏—â—ë–Ω–Ω–æ—Å—Ç–∏
‚îÇ   ‚îî‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ python/                          # Python (Pylecular)
‚îÇ   ‚îú‚îÄ‚îÄ pylecular_config.py          # Broker config (NATS, node-id)
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ml_service.py            # Isolation Forest, baseline, anomaly scoring
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ llm_service.py           # LLM chat, incident explanation
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ notification_service.py  # Telegram-–±–æ—Ç, email, webhook, syslog/CEF
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ad_sync_service.py       # Active Directory / LDAP sync
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ threat_intel_service.py  # abuse.ch, ThreatFox, STIX/TAXII –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä
‚îÇ   ‚îú‚îÄ‚îÄ ml/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ anomaly_detector.py      # Isolation Forest model
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ baseline_builder.py      # Traffic baseline
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ models/                  # Saved models (.pkl)
‚îÇ   ‚îú‚îÄ‚îÄ llm/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ providers.py             # Ollama, Claude, YandexGPT, GigaChat
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ prompts.py               # System prompts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ context_builder.py       # Graph context ‚Üí prompt
‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt
‚îÇ   ‚îî‚îÄ‚îÄ Dockerfile
‚îÇ   ‚îî‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ web/
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pages/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Dashboard.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ NetworkGraph.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Incidents.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ IncidentDetail.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Assets.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Assistant.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Simulation.tsx           # "–ß—Ç–æ –µ—Å–ª–∏?" —Å–∏–º—É–ª—è—Ü–∏—è –∞—Ç–∞–∫
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Segmentation.tsx         # Segmentation Score + —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Compliance.tsx           # Compliance-–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –æ—Ç—á—ë—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Reports.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Sensors.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/graph/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ NetworkGraph.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ BlastRadius.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AttackPath.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ SimulationOverlay.tsx    # Overlay –¥–ª—è "–ß—Ç–æ –µ—Å–ª–∏?"
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ GraphControls.tsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ api/
‚îÇ   ‚îî‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ deploy/
‚îÇ   ‚îú‚îÄ‚îÄ docker-compose.full.yml
‚îÇ   ‚îú‚îÄ‚îÄ docker-compose.server.yml
‚îÇ   ‚îú‚îÄ‚îÄ docker-compose.sensor.yml
‚îÇ   ‚îú‚îÄ‚îÄ dgraph/schema.graphql
‚îÇ   ‚îî‚îÄ‚îÄ docs/
‚îî‚îÄ‚îÄ README.md
```

---

## üõ† Tech Stack

| –°–ª–æ–π | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è | –ü–æ—á–µ–º—É |
|------|-----------|--------|
| Service Mesh (JS) | Moleculer.js 0.14 | Service discovery, event bus, API gateway |
| Service Mesh (Py) | Pylecular | Python-–Ω–æ–¥—ã –≤ Moleculer-–∫–ª–∞—Å—Ç–µ—Ä–µ —á–µ—Ä–µ–∑ NATS |
| Transport | NATS + JetStream | –ù–∞–¥—ë–∂–Ω—ã–π —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç —Å–µ–Ω—Å–æ—Ä‚Üî—Å–µ—Ä–≤–µ—Ä‚Üîpython |
| IDS Engine | Suricata 7 | –°—Ç–∞–Ω–¥–∞—Ä—Ç –∏–Ω–¥—É—Å—Ç—Ä–∏–∏ |
| Traffic Analysis | Zeek 6 | –õ—É—á—à–∏–π –¥–ª—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö |
| Event Storage | ClickHouse 24+ | SQL, —Å–∂–∞—Ç–∏–µ 5-10x, 1-2GB RAM (vs 8GB ES), TTL-–ø–∞—Ä—Ç–∏—Ü–∏–∏, —Å–æ–∑–¥–∞–Ω –Ø–Ω–¥–µ–∫—Å–æ–º |
| Graph DB | Dgraph 23+ | –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ, Apache 2.0 |
| App DB | PostgreSQL 16 | ACID |
| Cache | Redis 7 | –ö—ç—à, —Å–µ—Å—Å–∏–∏ |
| ML | Python + scikit-learn | Isolation Forest, anomaly detection |
| LLM Integration | Python + httpx/aiohttp | Ollama, Claude API, YandexGPT, GigaChat |
| AD Integration | Python + ldap3 | LDAP sync –∫–∞–∂–¥—ã–π —á–∞—Å, –æ–±–æ–≥–∞—â–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∞ |
| Notifications | Python + httpx | Telegram Bot API, Syslog/CEF, webhooks |
| TLS Fingerprint | Zeek JA3 + abuse.ch feed | –î–µ—Ç–µ–∫—Ü–∏—è Cobalt Strike, Metasploit –ø–æ TLS |
| Threat Intelligence | abuse.ch + STIX/TAXII 2.1 | –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ —Ñ–∏–¥—ã + –§–∏–Ω–¶–ï–†–¢, –ì–æ—Å–°–û–ü–ö–ê —á–µ—Ä–µ–∑ TAXII |
| Frontend | React + TypeScript | –≠–∫–æ—Å–∏—Å—Ç–µ–º–∞ |
| Graph Viz | Cytoscape.js | Compound nodes, layout |
| Charts | Recharts | –¢–∞–π–º–ª–∞–π–Ω—ã |
| Reports | Puppeteer | PDF –∏–∑ HTML |
| Deploy | Docker Compose | –û–¥–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ |

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ: Pylecular –¥–ª—è Python-—Å–µ—Ä–≤–∏—Å–æ–≤

**–ü–æ—á–µ–º—É –Ω–µ REST/gRPC –º–µ–∂–¥—É Node.js –∏ Python:**

Moleculer + Pylecular –æ–±—â–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ NATS –Ω–∞ –æ–¥–Ω–æ–º –ø—Ä–æ—Ç–æ–∫–æ–ª–µ. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç:
- **Service discovery** –∏–∑ –∫–æ—Ä–æ–±–∫–∏ ‚Äî Python-—Å–µ—Ä–≤–∏—Å—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∏–¥–Ω—ã –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ
- **Load balancing** ‚Äî –µ—Å–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å 3 ML-–Ω–æ–¥—ã, Moleculer —Å–∞–º –±–∞–ª–∞–Ω—Å–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã
- **Events** ‚Äî Python-—Å–µ—Ä–≤–∏—Å—ã –ø–æ–ª—É—á–∞—é—Ç –∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç —Å–æ–±—ã—Ç–∏—è –Ω–∞—Ä–∞–≤–Ω–µ —Å Node.js
- –ù–µ—Ç HTTP-–ø—Ä–æ—Å–ª–æ–π–∫–∏, –Ω–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ API, –Ω–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –æ—à–∏–±–æ–∫
- Node.js –≤—ã–∑—ã–≤–∞–µ—Ç `broker.call("ml.anomaly_detect", data)` ‚Äî –Ω–µ –∑–Ω–∞—è —á—Ç–æ —ç—Ç–æ Python

**–ß—Ç–æ –Ω–∞ Node.js (Moleculer):** API Gateway, ingestion, graph-builder, graph-analytics, correlation, incidents, assets, sensors, dashboard, reports, auth ‚Äî –≤—Å—ë —á—Ç–æ –ø—Ä–æ HTTP, WebSocket, Dgraph, ClickHouse.

**–ß—Ç–æ –Ω–∞ Python (Pylecular):** ML (Isolation Forest, baseline, anomaly scoring) –∏ LLM (Ollama, Claude API, YandexGPT, GigaChat) ‚Äî –≤—Å—ë —á—Ç–æ –ø—Ä–æ scikit-learn, numpy, LLM-–∫–ª–∏–µ–Ω—Ç—ã.

**Docker Compose:** –¥–≤–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ ‚Äî `ndr-server` (Node.js) –∏ `ndr-python` (Python). –û–±–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –∫ NATS. –ú–∞—Å—à—Ç–∞–±–∏—Ä—É—é—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ.

```yaml
# docker-compose.yml (—Ñ—Ä–∞–≥–º–µ–Ω—Ç)
services:
  nats:
    image: nats:2.10-alpine
    ports: ["4222:4222"]

  ndr-server:
    build: ./server
    depends_on: [nats, dgraph-alpha, clickhouse]
    environment:
      TRANSPORTER: nats://nats:4222

  ndr-python:
    build: ./python
    depends_on: [nats]
    environment:
      NATS_URL: nats://nats:4222
      LLM_PROVIDER: ollama  # –∏–ª–∏ claude, yandexgpt, gigachat
      TELEGRAM_BOT_TOKEN: ${TELEGRAM_BOT_TOKEN:-}
      TELEGRAM_CHAT_ID: ${TELEGRAM_CHAT_ID:-}
      AD_SERVER: ${AD_SERVER:-}
      AD_BIND_USER: ${AD_BIND_USER:-}
      AD_BIND_PASSWORD: ${AD_BIND_PASSWORD:-}
      AD_BASE_DN: ${AD_BASE_DN:-}
      SYSLOG_TARGET: ${SYSLOG_TARGET:-}  # ip:port –¥–ª—è CEF/syslog export
      # Threat Intelligence TAXII (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ ‚Äî –¥–ª—è –±–∞–Ω–∫–æ–≤/–ö–ò–ò)
      TAXII_FINCERT_URL: ${TAXII_FINCERT_URL:-}
      TAXII_FINCERT_USER: ${TAXII_FINCERT_USER:-}
      TAXII_FINCERT_PASSWORD: ${TAXII_FINCERT_PASSWORD:-}
      TAXII_GOSSOPKA_URL: ${TAXII_GOSSOPKA_URL:-}
      TAXII_GOSSOPKA_USER: ${TAXII_GOSSOPKA_USER:-}
      TAXII_GOSSOPKA_PASSWORD: ${TAXII_GOSSOPKA_PASSWORD:-}
    deploy:
      resources:
        reservations:
          devices:
            - capabilities: [gpu]  # —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ AI-appliance
```

---

## üìÖ Roadmap (18 –Ω–µ–¥–µ–ª—å)

### –§–∞–∑–∞ 1: Sensor + Pipeline + Graph (–Ω–µ–¥–µ–ª–∏ 1-5)

**–ù–µ–¥–µ–ª—è 1-2:** Docker —Å Suricata + Zeek + Moleculer node. –ü–∞—Ä—Å–∏–Ω–≥ eve.json –∏ Zeek –ª–æ–≥–æ–≤ (–≤–∫–ª—é—á–∞—è JA3 —Ö—ç—à–∏). NATS transporter. Sensor health. –¢–µ—Å—Ç –Ω–∞ PCAP.

**–ù–µ–¥–µ–ª—è 3-4:** –°–µ—Ä–≤–µ—Ä–Ω—ã–π Moleculer broker. Ingestion ‚Üí batch insert –≤ ClickHouse. Multi-sensor: –¥–≤–∞ —Å–µ–Ω—Å–æ—Ä–∞ ‚Üí –µ–¥–∏–Ω—ã–π –ø–æ—Ç–æ–∫.

**–ù–µ–¥–µ–ª—è 5:** Dgraph –≤ Docker. Schema (–≤–∫–ª—é—á–∞—è AD-–ø—Ä–µ–¥–∏–∫–∞—Ç—ã). Graph Builder: events ‚Üí Host/Domain/Alert nodes + edges. –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è. Baseline —á–µ—Ä–µ–∑ 24—á.

### –§–∞–∑–∞ 2: Correlation + Backend + AD (–Ω–µ–¥–µ–ª–∏ 6-9)

**–ù–µ–¥–µ–ª—è 6-7:** 13 event-based –ø—Ä–∞–≤–∏–ª (–≤–∫–ª—é—á–∞—è JA3 fingerprinting). –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ ‚Üí –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã. MITRE –º–∞–ø–ø–∏–Ω–≥. Python ML Isolation Forest. **Threat Intelligence:** abuse.ch —Ñ–∏–¥—ã (Feodo, SSLBL, ThreatFox) ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ + –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–π —á–∞—Å.

**–ù–µ–¥–µ–ª—è 8:** 5 graph-based –ø—Ä–∞–≤–∏–ª (–ø–æ—Å–ª–µ baseline). Graph analytics: blast radius, attack paths, risk scoring. **AD/LDAP –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** (sync service, –æ–±–æ–≥–∞—â–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∞).

**–ù–µ–¥–µ–ª—è 9:** REST API + WebSocket. **Telegram-–±–æ—Ç** (notification service). Syslog/CEF export.

### –§–∞–∑–∞ 3: Frontend + LLM + Simulation (–Ω–µ–¥–µ–ª–∏ 10-14)

**–ù–µ–¥–µ–ª—è 10-11:** Dashboard. Cytoscape.js –≥—Ä–∞—Ñ —Å compound nodes. –§–∏–ª—å—Ç—Ä—ã, zoom, selection. **Segmentation Score** –≤–∏–¥–∂–µ—Ç –Ω–∞ dashboard.

**–ù–µ–¥–µ–ª—è 12:** Incidents list/detail. Attack path highlighting. Blast radius mode.

**–ù–µ–¥–µ–ª—è 13:** LLM –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è. AI –æ–±—ä—è—Å–Ω—è–µ—Ç –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã —Å AD-–∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º. Chat interface. **"–ß—Ç–æ –µ—Å–ª–∏?" —Å–∏–º—É–ª—è—Ü–∏—è** (Simulate compromise + mitigation –Ω–∞ –≥—Ä–∞—Ñ–µ).

**–ù–µ–¥–µ–ª—è 14:** Reports (PDF —Å –≥—Ä–∞—Ñ–∞–º–∏). **Compliance-–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä** (—à–∞–±–ª–æ–Ω—ã 187-–§–ó, –ì–û–°–¢ 57580). **STIX/TAXII –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä** (–§–∏–Ω–¶–ï–†–¢, –ì–æ—Å–°–û–ü–ö–ê). Sensor management UI. Settings.

### –§–∞–∑–∞ 4: Discovery + Polish + Launch (–Ω–µ–¥–µ–ª–∏ 15-18)

**–ù–µ–¥–µ–ª—è 15:** **NDR-lite Discovery** ‚Äî –≤—ã–¥–µ–ª–∏—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç (—Ç–æ–ª—å–∫–æ –∫–∞—Ä—Ç–∞ + –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏—è). –û—Ç–¥–µ–ª—å–Ω—ã–π –ª–µ–Ω–¥–∏–Ω–≥, —Ç–∞—Ä–∏—Ñ—ã.

**–ù–µ–¥–µ–ª—è 16:** Install wizard. docker-compose one-liner. Docs. Performance (500 nodes smooth). False positive tuning.

**–ù–µ–¥–µ–ª—è 17:** Beta —Å 3 –∫–ª–∏–µ–Ω—Ç–∞–º–∏. Feedback loop. Bug-fix.

**–ù–µ–¥–µ–ª—è 18:** Launch NDR-lite + Discovery. AD-based –ø—Ä–∞–≤–∏–ª–∞ (19, 20) ‚Äî –µ—Å–ª–∏ AD –ø–æ–¥–∫–ª—é—á—ë–Ω —É beta-–∫–ª–∏–µ–Ω—Ç–æ–≤.

---

## üí∞ –≠–∫–æ–Ω–æ–º–∏–∫–∞

### –°—Ç–æ–∏–º–æ—Å—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

| –°—Ç–∞—Ç—å—è | –°—Ç–æ–∏–º–æ—Å—Ç—å |
|--------|----------|
| Backend (3 —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ √ó 4 –º–µ—Å) | 3.6 –º–ª–Ω —Ä—É–± |
| Frontend (1 —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ √ó 3.5 –º–µ—Å) | 1.05 –º–ª–Ω —Ä—É–± |
| ML/Data (0.5 —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ √ó 2 –º–µ—Å) | 0.3 –º–ª–Ω —Ä—É–± |
| DevOps/QA (0.5 √ó 4 –º–µ—Å) | 0.6 –º–ª–Ω —Ä—É–± |
| **–ò—Ç–æ–≥–æ** | **~5.5 –º–ª–Ω —Ä—É–±** |

### –ú–æ–¥–µ–ª—å –ø–æ–¥–ø–∏—Å–∫–∏

**NDR-lite (–ø–æ–ª–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç):**

| –¢–∞—Ä–∏—Ñ | –°–µ–Ω—Å–æ—Ä—ã | –•–æ—Å—Ç—ã | –¶–µ–Ω–∞/–º–µ—Å | –¶–µ–Ω–∞/–≥–æ–¥ |
|-------|---------|-------|----------|----------|
| **Free** | 1 | –¥–æ 50 | 0 | 0 |
| **Pro S** | 2 | –¥–æ 200 | 70–∫ | 756–∫ |
| **Pro M** | 3 | –¥–æ 500 | 130–∫ | 1.4 –º–ª–Ω |
| **Pro L** | 5 | –¥–æ 1000 | 200–∫ | 2.16 –º–ª–Ω |
| **Enterprise** | ‚àû | ‚àû | –æ—Ç 250–∫ | –æ—Ç 2.7 –º–ª–Ω |

Pro M/L –≤–∫–ª—é—á–∞—é—Ç: —Å–∏–º—É–ª—è—Ü–∏—é –∞—Ç–∞–∫ "–ß—Ç–æ –µ—Å–ª–∏?", compliance-–æ—Ç—á—ë—Ç—ã, Segmentation Score, AD-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é.

**NDR-lite Discovery (—Ç–æ–ª—å–∫–æ –∫–∞—Ä—Ç–∞ —Å–µ—Ç–∏):**

| –¢–∞—Ä–∏—Ñ | –•–æ—Å—Ç—ã | –¶–µ–Ω–∞/–º–µ—Å | –¶–µ–Ω–∞/–≥–æ–¥ |
|-------|-------|----------|----------|
| Discovery Free | –¥–æ 30 | 0 | 0 |
| Discovery Pro | –¥–æ 200 | 30–∫ | 324–∫ |
| Discovery Business | –¥–æ 1000 | 60–∫ | 648–∫ |

Discovery ‚Äî –≤–æ—Ä–æ–Ω–∫–∞ –≤ –ø–æ–ª–Ω—ã–π NDR-lite. –ê–ø–≥—Ä–µ–π–¥ —Å –∑–∞—á—ë—Ç–æ–º –æ–ø–ª–∞—á–µ–Ω–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞.

**–†–∞–∑–æ–≤—ã–µ —É—Å–ª—É–≥–∏:**

| –£—Å–ª—É–≥–∞ | –¶–µ–Ω–∞ |
|--------|------|
| –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –∞—É–¥–∏—Ç 48—á | 0 |
| Compliance-–æ—Ç—á—ë—Ç (—Ä–∞–∑–æ–≤—ã–π) | 50-100–∫ |
| Simulation report (—Ä–∞–∑–æ–≤—ã–π) | 30-50–∫ |

### Unit economics

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|---------|----------|
| ARPU (—Å—Ä–µ–¥–Ω–∏–π Pro) | 130–∫/–º–µ—Å = 1.56 –º–ª–Ω/–≥–æ–¥ |
| –°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å –∫–ª–∏–µ–Ω—Ç–∞ (—Ö–æ—Å—Ç–∏–Ω–≥, –ø–æ–¥–¥–µ—Ä–∂–∫–∞) | ~15–∫/–º–µ—Å |
| –ú–∞—Ä–∂–∞ | ~88% |
| CAC (—á–µ—Ä–µ–∑ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –∞—É–¥–∏—Ç) | ~100–∫ |
| LTV (—Å—Ä–µ–¥–Ω. 2 –≥–æ–¥–∞) | 3.12 –º–ª–Ω |
| LTV/CAC | 31x |
| Break-even | 12-15 Pro –∫–ª–∏–µ–Ω—Ç–æ–≤ |

### Go-to-market

**–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –∞—É–¥–∏—Ç 48—á** ‚Äî –∫–ª—é—á–µ–≤–æ–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç:
1. –ü—Ä–∏–µ–∑–∂–∞–µ–º / —É–¥–∞–ª—ë–Ω–Ω–æ —Å—Ç–∞–≤–∏–º —Å–µ–Ω—Å–æ—Ä (30 –º–∏–Ω)
2. 48 —á–∞—Å–æ–≤ —Å–æ–±–∏—Ä–∞–µ–º —Ç—Ä–∞—Ñ–∏–∫
3. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∫—Ä–∞—Å–∏–≤—ã–π PDF: –∫–∞—Ä—Ç–∞ —Å–µ—Ç–∏, –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã, –ø—É—Ç–∏ –∞—Ç–∞–∫, —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
4. –ü–æ–∫–∞–∑—ã–≤–∞–µ–º: ¬´–í–æ—Ç —á—Ç–æ –º—ã –Ω–∞—à–ª–∏ –∑–∞ 2 –¥–Ω—è. –•–æ—Ç–∏—Ç–µ –≤–∏–¥–µ—Ç—å —ç—Ç–æ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ?¬ª
5. –ö–æ–Ω–≤–µ—Ä—Å–∏—è: –æ–∂–∏–¥–∞–µ–º 30-40% –∏–∑ –∞—É–¥–∏—Ç–∞ –≤ –ø–æ–¥–ø–∏—Å–∫—É

---

## ‚úÖ Definition of Done

MVP –≥–æ—Ç–æ–≤, –∫–æ–≥–¥–∞:

- [ ] –°–µ–Ω—Å–æ—Ä —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π –∑–∞ <30 –º–∏–Ω—É—Ç
- [ ] –í—Ç–æ—Ä–æ–π —Å–µ–Ω—Å–æ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ NATS
- [ ] –ß–µ—Ä–µ–∑ 24 —á–∞—Å–∞: –≥—Ä–∞—Ñ —Å–µ—Ç–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω, baseline –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω
- [ ] –ì—Ä–∞—Ñ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ç–æ–ø–æ–ª–æ–≥–∏—é —Å compound nodes –ø–æ –ø–æ–¥—Å–µ—Ç—è–º
- [ ] –î–µ—Ç–µ–∫—Ç–∏—Ä—É—é—Ç—Å—è –º–∏–Ω–∏–º—É–º 16 –∏–∑ 20 –ø—Ä–∞–≤–∏–ª (—Ç–µ—Å—Ç –Ω–∞ PCAP)
- [ ] JA3 fingerprinting —Ä–∞–±–æ—Ç–∞–µ—Ç (Cobalt Strike beacon –¥–µ—Ç–µ–∫—Ç–∏—Ä—É–µ—Ç—Å—è)
- [ ] Lateral movement chain –∑–∞ <5 —Å–µ–∫—É–Ω–¥
- [ ] Blast radius –∑–∞ <2 —Å–µ–∫—É–Ω–¥—ã
- [ ] Risk score –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
- [ ] False positive rate <20% –Ω–∞ —Ç–∏–ø–∏—á–Ω–æ–º –æ—Ñ–∏—Å–Ω–æ–º —Ç—Ä–∞—Ñ–∏–∫–µ
- [ ] AI –æ–±—ä—è—Å–Ω—è–µ—Ç –∏–Ω—Ü–∏–¥–µ–Ω—Ç —Å –≥—Ä–∞—Ñ–æ–≤—ã–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º –∑–∞ <15 —Å–µ–∫—É–Ω–¥
- [ ] –ì—Ä–∞—Ñ –ø–ª–∞–≤–Ω—ã–π –ø—Ä–∏ 500 –Ω–æ–¥–∞—Ö
- [ ] PDF-–æ—Ç—á—ë—Ç —Å –≥—Ä–∞—Ñ–æ–º –∑–∞ <60 —Å–µ–∫—É–Ω–¥
- [ ] docker-compose up –∑–∞ <5 –º–∏–Ω—É—Ç
- [ ] Telegram-–±–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∞–ª–µ—Ä—Ç—ã —Å –∫–Ω–æ–ø–∫–∞–º–∏ –¥–µ–π—Å—Ç–≤–∏–π
- [ ] Syslog/CEF export —Ä–∞–±–æ—Ç–∞–µ—Ç —Å MaxPatrol SIEM (—Ç–µ—Å—Ç)
- [ ] Threat Intelligence: abuse.ch —Ñ–∏–¥—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ (<30 —Å–µ–∫)
- [ ] Threat Intelligence: C2 IP –∏–∑ Feodo Tracker –º–∞—Ç—á–∏—Ç—Å—è –≤ –ø—Ä–∞–≤–∏–ª–µ #4
- [ ] Threat Intelligence: JA3 –∏–∑ SSLBL –º–∞—Ç—á–∏—Ç—Å—è –≤ –ø—Ä–∞–≤–∏–ª–µ #11
- [ ] STIX/TAXII –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä: –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Ç–µ—Å—Ç–æ–≤–æ–º—É TAXII-—Å–µ—Ä–≤–µ—Ä—É —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] AD-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è: —Ö–æ—Å—Ç—ã –æ–±–æ–≥–∞—â–µ–Ω—ã –∏–º–µ–Ω–∞–º–∏ –∏ –æ—Ç–¥–µ–ª–∞–º–∏
- [ ] "–ß—Ç–æ –µ—Å–ª–∏?" ‚Äî simulate compromise –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç blast radius + paths
- [ ] "–ß—Ç–æ –µ—Å–ª–∏?" ‚Äî simulate mitigation –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç before/after
- [ ] Segmentation Score —Å—á–∏—Ç–∞–µ—Ç—Å—è –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –Ω–∞ dashboard
- [ ] Compliance: –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –ê–∫—Ç –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏–∏ (187-–§–ó)
- [ ] NDR-lite Discovery —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç
- [ ] 3 beta-–∫–ª–∏–µ–Ω—Ç–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—Ç —Ü–µ–Ω–Ω–æ—Å—Ç—å
